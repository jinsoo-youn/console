{"version":3,"file":"claim-modal-452d49fadc8480c1607c.js","sources":["webpack:///./public/components/hypercloud/modals/claim-modal.jsx"],"sourcesContent":["import * as _ from 'lodash-es';\nimport { ValidTabGuard } from 'packages/kubevirt-plugin/src/components/create-vm-wizard/tabs/valid-tab-guard';\nimport * as React from 'react';\n\nimport { k8sUpdateClaim, referenceForModel } from '../../../module/k8s';\nimport { createModalLauncher, ModalTitle, ModalBody, ModalSubmitFooter } from '../../factory/modal';\nimport { PromiseComponent, ResourceIcon, SelectorInput } from '../../utils';\n\nconst STATUS_PATH = '/status/phase';\nconst REASON_PATH = '/status/reason';\n// const STATUS_PATH = '/status';\nconst TEMPLATE_SELECTOR_PATH = '/spec/template/metadata/status';\n\nclass BaseClaimModal extends PromiseComponent {\n    constructor(props) {\n        super(props);\n        this._submit = this._submit.bind(this);\n        this._cancel = props.cancel.bind(this);\n        let status = _.get(props.resource, props.path.split('/').slice(1));\n        if (status === 'Awaiting') {\n            status = 'Approved';\n        }\n        const reason = _.get(props.resource, props.reasonPath.split('/').slice(1));\n        this.state = Object.assign(this.state, {\n            status,\n            reason\n        });\n    }\n\n    _submit(e) {\n        e.preventDefault();\n\n        const { kind, resource } = this.props;\n        const clusterClaim = resource.metadata.name;\n\n        // resourceURL\n        const admit = this.state.status === 'Approved' ? true : false;\n\n        const reason = this.state.reason;\n\n        const promise = k8sUpdateClaim(kind, clusterClaim, admit, reason);\n        this.handlePromise(promise)\n            .then(this.successSubmit);\n    }\n\n    successSubmit = () => {\n        this.props.close();\n        location.reload();\n    }\n\n    onChangeApproval = (e) => {\n        this.setState({ status: e.target.value });\n    }\n\n    onChangeReason = (e) => {\n        this.setState({ reason: e.target.value });\n    }\n\n    render() {\n        const { kind, resource, description, message } = this.props;\n\n        return (\n            <form onSubmit={this._submit} name=\"form\" className=\"modal-content\">\n                <ModalTitle>Approval Processing</ModalTitle>\n                <ModalBody>\n                    <div className=\"row co-m-form-row\">\n                        <div className=\"col-sm-12\">\n                            {message || ''}\n                        </div>\n                    </div>\n                    <div className=\"row co-m=-form-row\">\n                        <div className=\"col-sm-12\" style={{ marginBottom: '15px' }}>\n                            <select className=\"col-sm-12\" value={this.state.status} onChange={this.onChangeApproval}>\n                                <option value=\"Approved\">Approved</option>\n                                <option value=\"Rejected\">Rejected</option>\n                            </select>\n                        </div>\n                        <div className=\"col-sm-12\">\n                            <textarea className=\"col-sm-12\" style={{ height: '100px' }} onChange={this.onChangeReason} value={this.state.reason} />\n                        </div>\n                        <div className=\"col-sm-12\">\n                            Please enter a reason for refusal.\n                        </div>\n                    </div>\n                </ModalBody>\n                <ModalSubmitFooter\n                    errorMessage={this.state.errorMessage}\n                    inProgress={this.state.inProgress}\n                    submitText=\"Confirm\"\n                    cancel={this._cancel}\n                />\n            </form>\n        )\n    }\n}\n\nexport const claimModal = createModalLauncher((props) => (\n    <BaseClaimModal path={STATUS_PATH} reasonPath={REASON_PATH} {...props} />\n));"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AA8BA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAeA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AAKA;AAQA;AACA;AAEA;;;;;A","sourceRoot":""}