{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/console-app/src/actions/modify-health-checks.ts","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/console-app/src/actions/modify-health-checks.ts","mtime":1616735742370},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as _ from 'lodash';\nimport { referenceFor } from '@console/internal/module/k8s';\nimport { useTranslation } from 'react-i18next';\nconst healthChecksAdded = (resource) => {\n    var _a, _b, _c;\n    const containers = (_c = (_b = (_a = resource === null || resource === void 0 ? void 0 : resource.spec) === null || _a === void 0 ? void 0 : _a.template) === null || _b === void 0 ? void 0 : _b.spec) === null || _c === void 0 ? void 0 : _c.containers;\n    return _.every(containers, (container) => container.readinessProbe || container.livenessProbe || container.startupProbe);\n};\nconst healthChecksUrl = (model, obj) => {\n    var _a, _b, _c, _d;\n    const { kind, metadata: { name, namespace }, } = obj;\n    const resourceKind = model.crd ? referenceFor(obj) : kind;\n    const containers = (_c = (_b = (_a = obj === null || obj === void 0 ? void 0 : obj.spec) === null || _a === void 0 ? void 0 : _a.template) === null || _b === void 0 ? void 0 : _b.spec) === null || _c === void 0 ? void 0 : _c.containers;\n    const containerName = (_d = containers === null || containers === void 0 ? void 0 : containers[0]) === null || _d === void 0 ? void 0 : _d.name;\n    return `/k8s/ns/${namespace}/${resourceKind}/${name}/containers/${containerName}/health-checks`;\n};\nexport const AddHealthChecks = (model, obj) => {\n    const { t } = useTranslation();\n    return {\n        label: t('COMMON:MSG_MAIN_ACTIONBUTTON_14'),\n        hidden: healthChecksAdded(obj),\n        href: healthChecksUrl(model, obj),\n        accessReview: {\n            group: model.apiGroup,\n            resource: model.plural,\n            name: obj.metadata.name,\n            namespace: obj.metadata.namespace,\n            verb: 'update',\n        },\n    };\n};\nexport const EditHealthChecks = (model, obj) => {\n    const { t } = useTranslation();\n    return {\n        label: t('COMMON:MSG_MAIN_ACTIONBUTTON_9'),\n        hidden: !healthChecksAdded(obj),\n        href: healthChecksUrl(model, obj),\n        accessReview: {\n            group: model.apiGroup,\n            resource: model.plural,\n            name: obj.metadata.name,\n            namespace: obj.metadata.namespace,\n            verb: 'update',\n        },\n    };\n};\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/console-app/src/actions/modify-health-checks.ts","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/console-app/src/actions/modify-health-checks.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,CAAC,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAA4B,YAAY,EAAE,MAAM,8BAA8B,CAAC;AAEtF,OAAO,EAAE,cAAc,EAAE,MAAM,eAAe,CAAC;AAE/C,MAAM,iBAAiB,GAAG,CAAC,QAAyB,EAAW,EAAE;;IAC/D,MAAM,UAAU,qBAAG,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,IAAI,0CAAE,QAAQ,0CAAE,IAAI,0CAAE,UAAU,CAAC;IAC9D,OAAO,CAAC,CAAC,KAAK,CACZ,UAAU,EACV,CAAC,SAAS,EAAE,EAAE,CAAC,SAAS,CAAC,cAAc,IAAI,SAAS,CAAC,aAAa,IAAI,SAAS,CAAC,YAAY,CAC7F,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,eAAe,GAAG,CAAC,KAAc,EAAE,GAAoB,EAAU,EAAE;;IACvE,MAAM,EACJ,IAAI,EACJ,QAAQ,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,GAC9B,GAAG,GAAG,CAAC;IACR,MAAM,YAAY,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IAC1D,MAAM,UAAU,qBAAG,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,IAAI,0CAAE,QAAQ,0CAAE,IAAI,0CAAE,UAAU,CAAC;IACzD,MAAM,aAAa,SAAG,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAG,CAAC,2CAAG,IAAI,CAAC;IAC5C,OAAO,WAAW,SAAS,IAAI,YAAY,IAAI,IAAI,eAAe,aAAa,gBAAgB,CAAC;AAClG,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,eAAe,GAAG,CAAC,KAAc,EAAE,GAAoB,EAAe,EAAE;IACnF,MAAM,EAAE,CAAC,EAAE,GAAG,cAAc,EAAE,CAAC;IAC/B,OAAO;QACL,KAAK,EAAE,CAAC,CAAC,iCAAiC,CAAC;QAC3C,MAAM,EAAE,iBAAiB,CAAC,GAAG,CAAC;QAC9B,IAAI,EAAE,eAAe,CAAC,KAAK,EAAE,GAAG,CAAC;QACjC,YAAY,EAAE;YACZ,KAAK,EAAE,KAAK,CAAC,QAAQ;YACrB,QAAQ,EAAE,KAAK,CAAC,MAAM;YACtB,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,IAAI;YACvB,SAAS,EAAE,GAAG,CAAC,QAAQ,CAAC,SAAS;YACjC,IAAI,EAAE,QAAQ;SACf;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,KAAc,EAAE,GAAoB,EAAe,EAAE;IACpF,MAAM,EAAE,CAAC,EAAE,GAAG,cAAc,EAAE,CAAC;IAC/B,OAAO;QACL,KAAK,EAAE,CAAC,CAAC,gCAAgC,CAAC;QAC1C,MAAM,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC;QAC/B,IAAI,EAAE,eAAe,CAAC,KAAK,EAAE,GAAG,CAAC;QACjC,YAAY,EAAE;YACZ,KAAK,EAAE,KAAK,CAAC,QAAQ;YACrB,QAAQ,EAAE,KAAK,CAAC,MAAM;YACtB,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,IAAI;YACvB,SAAS,EAAE,GAAG,CAAC,QAAQ,CAAC,SAAS;YACjC,IAAI,EAAE,QAAQ;SACf;KACF,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import * as _ from 'lodash';\nimport { K8sKind, K8sResourceKind, referenceFor } from '@console/internal/module/k8s';\nimport { KebabOption } from '@console/internal/components/utils';\nimport { useTranslation } from 'react-i18next';\n\nconst healthChecksAdded = (resource: K8sResourceKind): boolean => {\n  const containers = resource?.spec?.template?.spec?.containers;\n  return _.every(\n    containers,\n    (container) => container.readinessProbe || container.livenessProbe || container.startupProbe,\n  );\n};\n\nconst healthChecksUrl = (model: K8sKind, obj: K8sResourceKind): string => {\n  const {\n    kind,\n    metadata: { name, namespace },\n  } = obj;\n  const resourceKind = model.crd ? referenceFor(obj) : kind;\n  const containers = obj?.spec?.template?.spec?.containers;\n  const containerName = containers?.[0]?.name;\n  return `/k8s/ns/${namespace}/${resourceKind}/${name}/containers/${containerName}/health-checks`;\n};\n\nexport const AddHealthChecks = (model: K8sKind, obj: K8sResourceKind): KebabOption => {\n  const { t } = useTranslation();\n  return {\n    label: t('COMMON:MSG_MAIN_ACTIONBUTTON_14'),\n    hidden: healthChecksAdded(obj),\n    href: healthChecksUrl(model, obj),\n    accessReview: {\n      group: model.apiGroup,\n      resource: model.plural,\n      name: obj.metadata.name,\n      namespace: obj.metadata.namespace,\n      verb: 'update',\n    },\n  };\n};\n\nexport const EditHealthChecks = (model: K8sKind, obj: K8sResourceKind): KebabOption => {\n  const { t } = useTranslation();\n  return {\n    label: t('COMMON:MSG_MAIN_ACTIONBUTTON_9'),\n    hidden: !healthChecksAdded(obj),\n    href: healthChecksUrl(model, obj),\n    accessReview: {\n      group: model.apiGroup,\n      resource: model.plural,\n      name: obj.metadata.name,\n      namespace: obj.metadata.namespace,\n      verb: 'update',\n    },\n  };\n};\n"]}]}