{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/public/components/RBAC/role.jsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/RBAC/role.jsx","mtime":1615793099690},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as _ from 'lodash-es';\nimport * as React from 'react';\nimport * as fuzzy from 'fuzzysearch';\n// import { Link } from 'react-router-dom';\nimport { RoleModel } from '../../models';\nimport * as classNames from 'classnames';\nimport { sortable } from '@patternfly/react-table';\nimport { flatten as bindingsFlatten } from './bindings';\nimport { BindingsList, RulesList } from './index';\nimport { DetailsPage, MultiListPage, TextFilter, Table, TableRow, TableData } from '../factory';\nimport { Kebab, SectionHeading, MsgBox, navFactory, ResourceKebab, ResourceLink, Timestamp } from '../utils';\nimport { useTranslation, withTranslation } from 'react-i18next';\nexport const isSystemRole = role => _.startsWith(role.metadata.name, 'system:');\n// const addHref = (name, ns) => ns ? `/k8s/ns/${ns}/roles/${name}/add-rule` : `/k8s/cluster/clusterroles/${name}/add-rule`;\nexport const roleKind = role => (role.metadata.namespace ? 'Role' : 'ClusterRole');\nconst menuActions = [\n    // This page is temporarily disabled until we update the safe resources list.\n    // (kind, role) => ({\n    //   label: 'Add Rule',\n    //   href: addHref(role.metadata.name, role.metadata.namespace),\n    // }),\n    (kind, role) => ({\n        label: 'Add Role Binding',\n        href: `/k8s/cluster/rolebindings/~new?rolekind=${roleKind(role)}&rolename=${role.metadata.name}`,\n    }),\n    Kebab.factory.Edit,\n    Kebab.factory.Delete,\n];\nconst roleColumnClasses = [classNames('col-xs-6'), classNames('col-xs-6'), Kebab.columnClass];\nconst RolesTableHeader = t => {\n    return [\n        {\n            title: t('COMMON:MSG_MAIN_TABLEHEADER_1'),\n            sortField: 'metadata.name',\n            transforms: [sortable],\n            props: { className: roleColumnClasses[0] },\n        },\n        {\n            title: t('COMMON:MSG_MAIN_TABLEHEADER_2'),\n            sortField: 'metadata.namespace',\n            transforms: [sortable],\n            props: { className: roleColumnClasses[1] },\n        },\n        { title: '', props: { className: roleColumnClasses[2] } },\n    ];\n};\nRolesTableHeader.displayName = 'RolesTableHeader';\nconst RolesTableRow = ({ obj: role, index, key, style }) => {\n    return (React.createElement(TableRow, { id: role.metadata.uid, index: index, trKey: key, style: style },\n        React.createElement(TableData, { className: roleColumnClasses[0] },\n            React.createElement(ResourceLink, { kind: roleKind(role), name: role.metadata.name, namespace: role.metadata.namespace })),\n        React.createElement(TableData, { className: classNames(roleColumnClasses[1], 'co-break-word') }, role.metadata.namespace ? React.createElement(ResourceLink, { kind: \"Namespace\", name: role.metadata.namespace }) : 'All Namespaces'),\n        React.createElement(TableData, { className: roleColumnClasses[2] },\n            React.createElement(ResourceKebab, { actions: menuActions, kind: roleKind(role), resource: role }))));\n};\nclass Details extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n        this.changeFilter = val => this.setState({ ruleFilter: val });\n    }\n    render() {\n        const ruleObj = this.props.obj;\n        const { creationTimestamp, name, namespace } = ruleObj.metadata;\n        const { ruleFilter } = this.state;\n        const { t } = this.props;\n        let rules = ruleObj.rules;\n        if (ruleFilter) {\n            const fuzzyCaseInsensitive = (a, b) => fuzzy(_.toLower(a), _.toLower(b));\n            const searchKeys = ['nonResourceURLs', 'resources', 'verbs'];\n            rules = rules.filter(rule => searchKeys.some(k => _.some(rule[k], v => fuzzyCaseInsensitive(ruleFilter, v))));\n        }\n        return (React.createElement(\"div\", null,\n            React.createElement(\"div\", { className: \"co-m-pane__body\" },\n                React.createElement(SectionHeading, { text: t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_1', { 0: t('COMMON:MSG_LNB_MENU_75') }) }),\n                React.createElement(\"div\", { className: \"row\" },\n                    React.createElement(\"div\", { className: \"col-xs-6\" },\n                        React.createElement(\"dl\", { className: \"co-m-pane__details\" },\n                            React.createElement(\"dt\", null, t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_115')),\n                            React.createElement(\"dd\", null, name),\n                            namespace && (React.createElement(\"div\", null,\n                                React.createElement(\"dt\", null, t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_6')),\n                                React.createElement(\"dd\", null,\n                                    React.createElement(ResourceLink, { kind: \"Namespace\", name: namespace })))))),\n                    React.createElement(\"div\", { className: \"col-xs-6\" },\n                        React.createElement(\"dl\", { className: \"co-m-pane__details\" },\n                            React.createElement(\"dt\", null, t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_43')),\n                            React.createElement(\"dd\", null,\n                                React.createElement(Timestamp, { timestamp: creationTimestamp })))))),\n            React.createElement(\"div\", { className: \"co-m-pane__body\" },\n                React.createElement(SectionHeading, { text: t('COMMON:MSG_DETAILS_TABDETAILS_RULES_1') }),\n                React.createElement(\"div\", { className: \"co-m-pane__filter-bar co-m-pane__filter-bar--alt\" },\n                    React.createElement(\"div\", { className: \"co-m-pane__filter-bar-group co-m-pane__filter-bar-group--filter\" },\n                        React.createElement(TextFilter, { label: t('COMMON:MSG_COMMON_SEARCH_PLACEHOLDER_2'), onChange: this.changeFilter }))),\n                React.createElement(RulesList, { rules: rules, name: name, namespace: namespace }))));\n    }\n}\nconst bindingsColumnClasses = [classNames('col-xs-4'), classNames('col-xs-2'), classNames('col-xs-4'), classNames('col-xs-2')];\n// const BindingsTableHeader = () => {\n//   return [\n//     {\n//       title: 'Name',\n//       sortField: 'metadata.name',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[0] },\n//     },\n//     {\n//       title: 'Subject Kind',\n//       sortField: 'subject.kind',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[1] },\n//     },\n//     {\n//       title: 'Subject Name',\n//       sortField: 'subject.name',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[2] },\n//     },\n//     {\n//       title: 'Namespace',\n//       sortField: 'metadata.namespace',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[3] },\n//     },\n//   ];\n// };\n// BindingsTableHeader.displayName = 'BindingsTableHeader';\n// const BindingsTableRow = ({ obj: binding, index, key, style }) => {\n//   return (\n//     <TableRow id={binding.metadata.uid} index={index} trKey={key} style={style}>\n//       <TableData className={bindingsColumnClasses[0]}>\n//         <BindingName binding={binding} />\n//       </TableData>\n//       <TableData className={bindingsColumnClasses[1]}>{binding.subject.kind}</TableData>\n//       <TableData className={bindingsColumnClasses[2]}>{binding.subject.name}</TableData>\n//       <TableData className={bindingsColumnClasses[3]}>{binding.namespace || 'All Namespaces'}</TableData>\n//     </TableRow>\n//   );\n// };\nconst BindingsListComponent = props => React.createElement(BindingsList, Object.assign({}, props, { virtualize: true }));\nexport const BindingsForRolePage = props => {\n    const { match: { params: { name, ns }, }, obj: { kind }, } = props;\n    const { t } = useTranslation();\n    const resources = [{ kind: 'RoleBinding', namespaced: true }];\n    if (!ns) {\n        resources.push({ kind: 'ClusterRoleBinding', namespaced: false, optional: true });\n    }\n    return (React.createElement(MultiListPage, { canCreate: true, createButtonText: t('COMMON:MSG_MAIN_CREATEBUTTON_1', { 0: 'Binding' }), createProps: {\n            to: `/k8s/${ns ? `ns/${ns}` : 'cluster'}/rolebindings/~new?rolekind=${kind}&rolename=${name}`,\n        }, ListComponent: BindingsListComponent, staticFilters: [{ 'role-binding-roleRef-name': name }, { 'role-binding-roleRef-kind': kind }], resources: resources, textFilter: \"role-binding\", filterLabel: \"by role or subject\", namespace: ns, flatten: bindingsFlatten }));\n};\nexport const RolesDetailsPage = props => React.createElement(DetailsPage, Object.assign({}, props, { pages: [navFactory.details(withTranslation()(Details)), navFactory.editYaml(), { href: 'bindings', name: 'Role Bindings', component: BindingsForRolePage }], menuActions: menuActions }));\nexport const ClusterRolesDetailsPage = RolesDetailsPage;\nconst EmptyMsg = () => React.createElement(MsgBox, { title: \"No Roles Found\", detail: \"Roles grant access to types of objects in the cluster. Roles are applied to a team or user via a Role Binding.\" });\nconst RolesList = props => {\n    const { t } = useTranslation();\n    return React.createElement(Table, Object.assign({}, props, { \"aria-label\": \"Roles\", EmptyMsg: EmptyMsg, Header: RolesTableHeader.bind(null, t), Row: RolesTableRow, virtualize: true }));\n};\nexport const roleType = role => {\n    if (!role) {\n        return undefined;\n    }\n    if (isSystemRole(role)) {\n        return 'system';\n    }\n    return role.metadata.namespace ? 'namespace' : 'cluster';\n};\nexport const RolesPage = ({ namespace, mock, showTitle }) => {\n    const { t } = useTranslation();\n    const createNS = namespace || 'default';\n    const accessReview = {\n        model: RoleModel,\n        namespace: createNS,\n    };\n    return (React.createElement(MultiListPage, { ListComponent: RolesList, canCreate: true, showTitle: showTitle, namespace: namespace, createAccessReview: accessReview, createButtonText: \"Create Role\", createProps: { to: `/k8s/ns/${createNS}/roles/~new` }, flatten: resources => _.flatMap(resources, 'data').filter(r => !!r), resources: [\n            { kind: 'Role', namespaced: true, optional: mock },\n            { kind: 'ClusterRole', namespaced: false, optional: true },\n        ], rowFilters: [\n            {\n                filterGroupName: 'Role',\n                type: 'role-kind',\n                reducer: roleType,\n                items: [\n                    { id: 'cluster', title: 'Cluster-wide Roles' },\n                    { id: 'namespace', title: 'Namespace Roles' },\n                    { id: 'system', title: 'System Roles' },\n                ],\n            },\n        ], title: t('COMMON:MSG_LNB_MENU_75') }));\n};\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/RBAC/role.jsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/public/components/RBAC/role.jsx"],"names":[],"mappings":"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","sourcesContent":["import * as _ from 'lodash-es';\nimport * as React from 'react';\nimport * as fuzzy from 'fuzzysearch';\n// import { Link } from 'react-router-dom';\nimport { RoleModel } from '../../models';\nimport * as classNames from 'classnames';\nimport { sortable } from '@patternfly/react-table';\nimport { flatten as bindingsFlatten } from './bindings';\nimport { BindingName, BindingsList, RulesList } from './index';\nimport { DetailsPage, MultiListPage, TextFilter, Table, TableRow, TableData } from '../factory';\nimport { Kebab, SectionHeading, MsgBox, navFactory, ResourceKebab, ResourceLink, Timestamp } from '../utils';\nimport { useTranslation, withTranslation } from 'react-i18next';\n\nexport const isSystemRole = role => _.startsWith(role.metadata.name, 'system:');\n\n// const addHref = (name, ns) => ns ? `/k8s/ns/${ns}/roles/${name}/add-rule` : `/k8s/cluster/clusterroles/${name}/add-rule`;\n\nexport const roleKind = role => (role.metadata.namespace ? 'Role' : 'ClusterRole');\n\nconst menuActions = [\n  // This page is temporarily disabled until we update the safe resources list.\n  // (kind, role) => ({\n  //   label: 'Add Rule',\n  //   href: addHref(role.metadata.name, role.metadata.namespace),\n  // }),\n  (kind, role) => ({\n    label: 'Add Role Binding',\n    href: `/k8s/cluster/rolebindings/~new?rolekind=${roleKind(role)}&rolename=${role.metadata.name}`,\n  }),\n  Kebab.factory.Edit,\n  Kebab.factory.Delete,\n];\n\nconst roleColumnClasses = [classNames('col-xs-6'), classNames('col-xs-6'), Kebab.columnClass];\n\nconst RolesTableHeader = t => {\n  return [\n    {\n      title: t('COMMON:MSG_MAIN_TABLEHEADER_1'),\n      sortField: 'metadata.name',\n      transforms: [sortable],\n      props: { className: roleColumnClasses[0] },\n    },\n    {\n      title: t('COMMON:MSG_MAIN_TABLEHEADER_2'),\n      sortField: 'metadata.namespace',\n      transforms: [sortable],\n      props: { className: roleColumnClasses[1] },\n    },\n    { title: '', props: { className: roleColumnClasses[2] } },\n  ];\n};\nRolesTableHeader.displayName = 'RolesTableHeader';\n\nconst RolesTableRow = ({ obj: role, index, key, style }) => {\n  return (\n    <TableRow id={role.metadata.uid} index={index} trKey={key} style={style}>\n      <TableData className={roleColumnClasses[0]}>\n        <ResourceLink kind={roleKind(role)} name={role.metadata.name} namespace={role.metadata.namespace} />\n      </TableData>\n      <TableData className={classNames(roleColumnClasses[1], 'co-break-word')}>{role.metadata.namespace ? <ResourceLink kind=\"Namespace\" name={role.metadata.namespace} /> : 'All Namespaces'}</TableData>\n      <TableData className={roleColumnClasses[2]}>\n        <ResourceKebab actions={menuActions} kind={roleKind(role)} resource={role} />\n      </TableData>\n    </TableRow>\n  );\n};\n\nclass Details extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.changeFilter = val => this.setState({ ruleFilter: val });\n  }\n  render() {\n    const ruleObj = this.props.obj;\n    const { creationTimestamp, name, namespace } = ruleObj.metadata;\n    const { ruleFilter } = this.state;\n    const { t } = this.props;\n    let rules = ruleObj.rules;\n    if (ruleFilter) {\n      const fuzzyCaseInsensitive = (a, b) => fuzzy(_.toLower(a), _.toLower(b));\n      const searchKeys = ['nonResourceURLs', 'resources', 'verbs'];\n      rules = rules.filter(rule => searchKeys.some(k => _.some(rule[k], v => fuzzyCaseInsensitive(ruleFilter, v))));\n    }\n    return (\n      <div>\n        <div className=\"co-m-pane__body\">\n          <SectionHeading text={t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_1', { 0: t('COMMON:MSG_LNB_MENU_75') })} />\n          <div className=\"row\">\n            <div className=\"col-xs-6\">\n              <dl className=\"co-m-pane__details\">\n                <dt>{t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_115')}</dt>\n                <dd>{name}</dd>\n                {namespace && (\n                  <div>\n                    <dt>{t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_6')}</dt>\n                    <dd>\n                      <ResourceLink kind=\"Namespace\" name={namespace} />\n                    </dd>\n                  </div>\n                )}\n              </dl>\n            </div>\n            <div className=\"col-xs-6\">\n              <dl className=\"co-m-pane__details\">\n                <dt>{t('COMMON:MSG_DETAILS_TABDETAILS_DETAILS_43')}</dt>\n                <dd>\n                  <Timestamp timestamp={creationTimestamp} />\n                </dd>\n              </dl>\n            </div>\n          </div>\n        </div>\n        <div className=\"co-m-pane__body\">\n          <SectionHeading text={t('COMMON:MSG_DETAILS_TABDETAILS_RULES_1')} />\n          <div className=\"co-m-pane__filter-bar co-m-pane__filter-bar--alt\">\n            {/* This page is temporarily disabled until we update the safe resources list.\n        <div className=\"co-m-pane__filter-bar-group\">\n          <Link to={addHref(name, namespace)} className=\"co-m-primary-action\">\n            <button className=\"btn btn-primary\">Add Rule</button>\n          </Link>\n        </div>\n        */}\n            <div className=\"co-m-pane__filter-bar-group co-m-pane__filter-bar-group--filter\">\n              <TextFilter label={t('COMMON:MSG_COMMON_SEARCH_PLACEHOLDER_2')} onChange={this.changeFilter} />\n            </div>\n          </div>\n          <RulesList rules={rules} name={name} namespace={namespace} />\n        </div>\n      </div>\n    );\n  }\n}\n\nconst bindingsColumnClasses = [classNames('col-xs-4'), classNames('col-xs-2'), classNames('col-xs-4'), classNames('col-xs-2')];\n\n// const BindingsTableHeader = () => {\n//   return [\n//     {\n//       title: 'Name',\n//       sortField: 'metadata.name',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[0] },\n//     },\n//     {\n//       title: 'Subject Kind',\n//       sortField: 'subject.kind',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[1] },\n//     },\n//     {\n//       title: 'Subject Name',\n//       sortField: 'subject.name',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[2] },\n//     },\n//     {\n//       title: 'Namespace',\n//       sortField: 'metadata.namespace',\n//       transforms: [sortable],\n//       props: { className: bindingsColumnClasses[3] },\n//     },\n//   ];\n// };\n// BindingsTableHeader.displayName = 'BindingsTableHeader';\n\n// const BindingsTableRow = ({ obj: binding, index, key, style }) => {\n//   return (\n//     <TableRow id={binding.metadata.uid} index={index} trKey={key} style={style}>\n//       <TableData className={bindingsColumnClasses[0]}>\n//         <BindingName binding={binding} />\n//       </TableData>\n//       <TableData className={bindingsColumnClasses[1]}>{binding.subject.kind}</TableData>\n//       <TableData className={bindingsColumnClasses[2]}>{binding.subject.name}</TableData>\n//       <TableData className={bindingsColumnClasses[3]}>{binding.namespace || 'All Namespaces'}</TableData>\n//     </TableRow>\n//   );\n// };\n\nconst BindingsListComponent = props => <BindingsList {...props} virtualize />;\n\nexport const BindingsForRolePage = props => {\n  const {\n    match: {\n      params: { name, ns },\n    },\n    obj: { kind },\n  } = props;\n  const { t } = useTranslation();\n  const resources = [{ kind: 'RoleBinding', namespaced: true }];\n  if (!ns) {\n    resources.push({ kind: 'ClusterRoleBinding', namespaced: false, optional: true });\n  }\n  return (\n    <MultiListPage\n      canCreate={true}\n      createButtonText={t('COMMON:MSG_MAIN_CREATEBUTTON_1', { 0: 'Binding' })}\n      createProps={{\n        to: `/k8s/${ns ? `ns/${ns}` : 'cluster'}/rolebindings/~new?rolekind=${kind}&rolename=${name}`,\n      }}\n      ListComponent={BindingsListComponent}\n      staticFilters={[{ 'role-binding-roleRef-name': name }, { 'role-binding-roleRef-kind': kind }]}\n      resources={resources}\n      textFilter=\"role-binding\"\n      filterLabel=\"by role or subject\"\n      namespace={ns}\n      flatten={bindingsFlatten}\n    />\n  );\n};\n\nexport const RolesDetailsPage = props => <DetailsPage {...props} pages={[navFactory.details(withTranslation()(Details)), navFactory.editYaml(), { href: 'bindings', name: 'Role Bindings', component: BindingsForRolePage }]} menuActions={menuActions} />;\n\nexport const ClusterRolesDetailsPage = RolesDetailsPage;\n\nconst EmptyMsg = () => <MsgBox title=\"No Roles Found\" detail=\"Roles grant access to types of objects in the cluster. Roles are applied to a team or user via a Role Binding.\" />;\n\nconst RolesList = props => {\n  const { t } = useTranslation();\n  return <Table {...props} aria-label=\"Roles\" EmptyMsg={EmptyMsg} Header={RolesTableHeader.bind(null, t)} Row={RolesTableRow} virtualize />;\n};\n\nexport const roleType = role => {\n  if (!role) {\n    return undefined;\n  }\n  if (isSystemRole(role)) {\n    return 'system';\n  }\n  return role.metadata.namespace ? 'namespace' : 'cluster';\n};\n\nexport const RolesPage = ({ namespace, mock, showTitle }) => {\n  const { t } = useTranslation();\n  const createNS = namespace || 'default';\n  const accessReview = {\n    model: RoleModel,\n    namespace: createNS,\n  };\n  return (\n    <MultiListPage\n      ListComponent={RolesList}\n      canCreate={true}\n      showTitle={showTitle}\n      namespace={namespace}\n      createAccessReview={accessReview}\n      createButtonText=\"Create Role\"\n      createProps={{ to: `/k8s/ns/${createNS}/roles/~new` }}\n      flatten={resources => _.flatMap(resources, 'data').filter(r => !!r)}\n      resources={[\n        { kind: 'Role', namespaced: true, optional: mock },\n        { kind: 'ClusterRole', namespaced: false, optional: true },\n      ]}\n      rowFilters={[\n        {\n          filterGroupName: 'Role',\n          type: 'role-kind',\n          reducer: roleType,\n          items: [\n            { id: 'cluster', title: 'Cluster-wide Roles' },\n            { id: 'namespace', title: 'Namespace Roles' },\n            { id: 'system', title: 'System Roles' },\n          ],\n        },\n      ]}\n      title={t('COMMON:MSG_LNB_MENU_75')}\n    />\n  );\n};\n"]}]}