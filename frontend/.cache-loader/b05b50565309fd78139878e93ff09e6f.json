{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/operator-lifecycle-manager/src/components/catalog-source.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/operator-lifecycle-manager/src/components/catalog-source.tsx","mtime":1615298458680},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport * as classNames from 'classnames';\nimport { CreateYAML } from '@console/internal/components/create-yaml';\nimport { sortable } from '@patternfly/react-table';\nimport { Button } from '@patternfly/react-core';\nimport { withFallback } from '@console/shared/src/components/error/error-boundary';\nimport { referenceForModel, k8sPatch, } from '@console/internal/module/k8s';\nimport { Firehose, Kebab, LoadingBox, MsgBox, navFactory, ResourceKebab, ResourceLink, SectionHeading, asAccessReview, } from '@console/internal/components/utils';\nimport { DetailsPage, Table, TableRow, TableData, MultiListPage, } from '@console/internal/components/factory';\nimport { ConfigMapModel } from '@console/internal/models';\nimport { PopoverStatus } from '@console/shared';\nimport { SubscriptionModel, CatalogSourceModel, PackageManifestModel, OperatorGroupModel, OperatorHubModel, } from '../models';\nimport { requireOperatorGroup } from './operator-group';\nimport { PackageManifestList } from './package-manifest';\nimport { deleteCatalogSourceModal } from './modals/delete-catalog-source-modal';\nimport { disableDefaultSourceModal } from './modals/disable-default-source-modal';\nconst DEFAULT_SOURCE_NAMESPACE = 'openshift-marketplace';\nconst catalogSourceModelReference = referenceForModel(CatalogSourceModel);\nconst deleteModal = (kind, catalogSource) => (Object.assign(Object.assign({}, Kebab.factory.Delete(kind, catalogSource)), { callback: () => deleteCatalogSourceModal({ kind, resource: catalogSource }) }));\nconst disableSourceModal = (kind, operatorHub, sourceName) => ({\n    label: 'Disable',\n    callback: () => disableDefaultSourceModal({ kind, operatorHub, sourceName }),\n    accessReview: asAccessReview(kind, operatorHub, 'patch'),\n});\nconst enableSource = (kind, operatorHub, sourceName) => ({\n    label: 'Enable',\n    callback: () => {\n        const currentSources = _.get(operatorHub, 'spec.sources', []);\n        const patch = [\n            {\n                op: 'add',\n                path: '/spec/sources',\n                value: _.filter(currentSources, (source) => source.name !== sourceName),\n            },\n        ];\n        return k8sPatch(kind, operatorHub, patch);\n    },\n    accessReview: asAccessReview(kind, operatorHub, 'patch'),\n});\nconst DefaultSourceKebab = ({ kind, operatorHub, sourceName, sourceDisabled, }) => {\n    const options = sourceDisabled\n        ? [enableSource(kind, operatorHub, sourceName)]\n        : [disableSourceModal(kind, operatorHub, sourceName)];\n    return React.createElement(Kebab, { options: options });\n};\nexport const CatalogSourceDetails = ({ obj, packageManifests, subscriptions, operatorGroups, }) => {\n    const toData = (data) => ({ loaded: true, data });\n    return !_.isEmpty(obj) ? (React.createElement(\"div\", { className: \"co-catalog-details co-m-pane\" },\n        React.createElement(\"div\", { className: \"co-m-pane__body\" },\n            React.createElement(\"div\", { className: \"col-xs-4\" },\n                React.createElement(\"dl\", { className: \"co-m-pane__details\" },\n                    React.createElement(\"dt\", null, \"Name\"),\n                    React.createElement(\"dd\", null, obj.spec.displayName))),\n            React.createElement(\"div\", { className: \"col-xs-4\" },\n                React.createElement(\"dl\", { className: \"co-m-pane__details\" },\n                    React.createElement(\"dt\", null, \"Publisher\"),\n                    React.createElement(\"dd\", null, obj.spec.publisher)))),\n        React.createElement(\"div\", { className: \"co-m-pane__body\" },\n            React.createElement(SectionHeading, { text: \"Packages\" }),\n            React.createElement(PackageManifestList, { loaded: true, data: packageManifests, operatorGroup: toData(operatorGroups), subscription: toData(subscriptions) })))) : (React.createElement(\"div\", null));\n};\nexport const CatalogSourceDetailsPage = (props) => (React.createElement(DetailsPage, Object.assign({}, props, { namespace: props.match.params.ns, kind: referenceForModel(CatalogSourceModel), name: props.match.params.name, pages: [navFactory.details(CatalogSourceDetails), navFactory.editYaml()], menuActions: Kebab.factory.common, resources: [\n        {\n            kind: referenceForModel(PackageManifestModel),\n            isList: true,\n            namespace: props.match.params.ns,\n            selector: { matchLabels: { catalog: props.match.params.name } },\n            prop: 'packageManifests',\n        },\n        {\n            kind: referenceForModel(SubscriptionModel),\n            isList: true,\n            namespace: props.match.params.ns,\n            prop: 'subscriptions',\n        },\n        {\n            kind: referenceForModel(OperatorGroupModel),\n            isList: true,\n            namespace: props.match.params.ns,\n            prop: 'operatorGroups',\n        },\n    ] })));\nexport const CreateSubscriptionYAML = (props) => {\n    const Create = requireOperatorGroup(withFallback((createProps) => {\n        if (createProps.packageManifest.loaded && createProps.packageManifest.data) {\n            const pkg = createProps.packageManifest.data;\n            const channel = pkg.status.defaultChannel\n                ? pkg.status.channels.find(({ name }) => name === pkg.status.defaultChannel)\n                : pkg.status.channels[0];\n            const template = `\n          apiVersion: ${SubscriptionModel.apiGroup}/${SubscriptionModel.apiVersion}\n          kind: ${SubscriptionModel.kind},\n          metadata:\n            generateName: ${pkg.metadata.name}-\n            namespace: default\n          spec:\n            source: ${new URLSearchParams(props.location.search).get('catalog')}\n            sourceNamespace: ${new URLSearchParams(props.location.search).get('catalogNamespace')}\n            name: ${pkg.metadata.name}\n            startingCSV: ${channel.currentCSV}\n            channel: ${channel.name}\n        `;\n            return (React.createElement(CreateYAML, Object.assign({}, props, { plural: SubscriptionModel.plural, template: template })));\n        }\n        return React.createElement(LoadingBox, null);\n    }, () => (React.createElement(MsgBox, { title: \"Package Not Found\", detail: \"Cannot create a Subscription to a non-existent package.\" }))));\n    return (React.createElement(Firehose, { resources: [\n            {\n                kind: referenceForModel(PackageManifestModel),\n                isList: false,\n                name: new URLSearchParams(props.location.search).get('pkg'),\n                namespace: new URLSearchParams(props.location.search).get('catalogNamespace'),\n                prop: 'packageManifest',\n            },\n            {\n                kind: referenceForModel(OperatorGroupModel),\n                isList: true,\n                namespace: props.match.params.ns,\n                prop: 'operatorGroup',\n            },\n        ] },\n        React.createElement(Create, Object.assign({}, props))));\n};\nconst tableColumnClasses = [\n    classNames('col-lg-3', 'col-md-3', 'col-sm-4', 'col-xs-6'),\n    classNames('col-lg-2', 'col-md-3', 'col-sm-4', 'col-xs-6'),\n    classNames('col-lg-2', 'col-md-3', 'col-sm-4', 'hidden-xs'),\n    classNames('col-lg-3', 'col-md-3', 'hidden-sm', 'hidden-xs'),\n    classNames('col-lg-2', 'hidden-md', 'hidden-sm', 'hidden-xs'),\n    Kebab.columnClass,\n];\nconst CatalogSourceHeader = () => {\n    return [\n        {\n            title: 'Name',\n            sortField: 'name',\n            transforms: [sortable],\n            props: { className: tableColumnClasses[0] },\n        },\n        {\n            title: 'Publisher',\n            sortField: 'publisher',\n            transforms: [sortable],\n            props: { className: tableColumnClasses[1] },\n        },\n        {\n            title: 'Availability',\n            sortField: 'availabilitySort',\n            transforms: [sortable],\n            props: { className: tableColumnClasses[2] },\n        },\n        {\n            title: 'Endpoint',\n            sortField: 'endpoint',\n            transforms: [sortable],\n            props: { className: tableColumnClasses[3] },\n        },\n        {\n            title: '# of Operators',\n            sortField: 'operatorCount',\n            transforms: [sortable],\n            props: { className: tableColumnClasses[4] },\n        },\n        {\n            title: '',\n            props: { className: tableColumnClasses[5] },\n        },\n    ];\n};\nconst getEndpoint = (catalogSource) => {\n    if (catalogSource.spec.configmap) {\n        return (React.createElement(ResourceLink, { kind: referenceForModel(ConfigMapModel), name: catalogSource.spec.configmap, namespace: catalogSource.metadata.namespace }));\n    }\n    return catalogSource.spec.image || catalogSource.spec.address;\n};\nconst getOperatorCount = (catalogSource, packageManifests) => _.filter(packageManifests, {\n    status: {\n        catalogSource: catalogSource.metadata.name,\n        catalogSourceNamespace: catalogSource.metadata.namespace,\n    },\n}).length; // Type inferred to prevent Lodash TypeScript error.\nconst CatalogSourceTableRow = ({ obj: { availability = '-', disabled = false, endpoint = '-', isDefault = false, name, operatorCount = 0, operatorHub, publisher = '-', source, }, index, key, style, }) => (React.createElement(TableRow, { className: disabled && 'catalog-source__table-row--disabled', id: source ? source.metadata.uid : index, index: index, style: style, trKey: key },\n    React.createElement(TableData, { className: tableColumnClasses[0] }, source ? (React.createElement(ResourceLink, { kind: catalogSourceModelReference, name: source.metadata.name, namespace: source.metadata.namespace, title: source.metadata.name })) : (name)),\n    React.createElement(TableData, { className: tableColumnClasses[1] }, publisher),\n    React.createElement(TableData, { className: tableColumnClasses[2] }, availability),\n    React.createElement(TableData, { className: tableColumnClasses[3] }, endpoint),\n    React.createElement(TableData, { className: tableColumnClasses[4] }, operatorCount || '-'),\n    React.createElement(TableData, { className: tableColumnClasses[5] }, isDefault ? (React.createElement(DefaultSourceKebab, { kind: OperatorHubModel, operatorHub: operatorHub, sourceName: name, sourceDisabled: disabled })) : (React.createElement(ResourceKebab, { actions: [Kebab.factory.Edit, deleteModal], kind: catalogSourceModelReference, resource: source })))));\nconst CatalogSourceList = (props) => (React.createElement(Table, Object.assign({}, props, { \"aria-label\": \"Catalog Sources\", Header: CatalogSourceHeader, Row: CatalogSourceTableRow })));\nconst DisabledPopover = ({ operatorHub, sourceName }) => {\n    const [visible, setVisible] = React.useState(null);\n    const close = React.useCallback(() => {\n        setVisible(false);\n    }, []);\n    const onClickEnable = React.useCallback(() => enableSource(OperatorHubModel, operatorHub, sourceName)\n        .callback()\n        .then(close), [close, operatorHub, sourceName]);\n    return (React.createElement(PopoverStatus, { title: \"Disabled\", isVisible: visible, shouldClose: close },\n        React.createElement(\"p\", null, \"Operators provided by this source will not appear in OperatorHub and any operators installed from this source will not receive updates unitl this source is re-enabled.\"),\n        React.createElement(Button, { isInline: true, variant: \"link\", onClick: onClickEnable }, \"Enable source\")));\n};\nconst flatten = ({ catalogSources, operatorHub, packageManifests, }) => {\n    const defaultSources = _.map(operatorHub.status.sources, (defaultSource) => {\n        const catalogSource = _.find(catalogSources.data, {\n            metadata: { name: defaultSource.name, namespace: DEFAULT_SOURCE_NAMESPACE },\n        });\n        const catalogSourceExists = !_.isEmpty(catalogSource);\n        return Object.assign({ availability: catalogSourceExists ? ('Cluster wide') : (React.createElement(DisabledPopover, { operatorHub: operatorHub, sourceName: defaultSource.name })), \n            // Add a string value for sorting by availability since React elements can't be sorted.\n            availabilitySort: catalogSourceExists ? 'Cluster wide' : 'Disabled', disabled: !catalogSourceExists, isDefault: true, name: defaultSource.name, namespace: DEFAULT_SOURCE_NAMESPACE, operatorHub }, (catalogSourceExists && {\n            source: catalogSource,\n            endpoint: getEndpoint(catalogSource),\n            operatorCount: getOperatorCount(catalogSource, packageManifests.data),\n            publisher: catalogSource.spec.publisher,\n        }));\n    });\n    const customSources = _.map(catalogSources.data, (source) => ({\n        availability: source.metadata.namespace === DEFAULT_SOURCE_NAMESPACE\n            ? 'Cluster wide'\n            : source.metadata.namespace,\n        endpoint: getEndpoint(source),\n        name: source.metadata.name,\n        namespace: source.metadata.namespace,\n        operatorCount: getOperatorCount(source, packageManifests.data),\n        operatorHub,\n        publisher: source.spec.publisher,\n        source,\n    }));\n    return _.unionWith(defaultSources, customSources, (a, b) => a.name === b.name && a.namespace === b.namespace);\n};\nexport const CatalogSourceListPage = (props) => (React.createElement(MultiListPage, Object.assign({}, props, { canCreate: true, createAccessReview: { model: CatalogSourceModel }, createButtonText: \"Create Catalog Source\", createProps: { to: `/k8s/cluster/${referenceForModel(CatalogSourceModel)}/~new` }, flatten: (data) => flatten(Object.assign({ operatorHub: props.obj }, data)), ListComponent: CatalogSourceList, textFilter: \"catalog-source-name\", hideLabelFilter: true, resources: [\n        {\n            isList: true,\n            kind: referenceForModel(PackageManifestModel),\n            prop: 'packageManifests',\n        },\n        {\n            isList: true,\n            kind: catalogSourceModelReference,\n            prop: 'catalogSources',\n        },\n    ] })));\nCatalogSourceDetails.displayName = 'CatalogSourceDetails';\nCatalogSourceDetailsPage.displayName = 'CatalogSourceDetailPage';\nCreateSubscriptionYAML.displayName = 'CreateSubscriptionYAML';\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/operator-lifecycle-manager/src/components/catalog-source.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/operator-lifecycle-manager/src/components/catalog-source.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport * as classNames from 'classnames';\nimport { match } from 'react-router-dom';\nimport { CreateYAML } from '@console/internal/components/create-yaml';\nimport { ListPageProps } from '@console/internal/components/monitoring';\nimport { sortable } from '@patternfly/react-table';\nimport { Button } from '@patternfly/react-core';\nimport { withFallback } from '@console/shared/src/components/error/error-boundary';\nimport {\n  K8sResourceKind,\n  referenceForModel,\n  K8sKind,\n  k8sPatch,\n} from '@console/internal/module/k8s';\nimport {\n  Firehose,\n  Kebab,\n  LoadingBox,\n  MsgBox,\n  navFactory,\n  ResourceKebab,\n  ResourceLink,\n  SectionHeading,\n  asAccessReview,\n  KebabOption,\n} from '@console/internal/components/utils';\nimport {\n  DetailsPage,\n  Table,\n  TableRow,\n  TableData,\n  TableProps,\n  MultiListPage,\n  RowFunction,\n} from '@console/internal/components/factory';\nimport { ConfigMapModel } from '@console/internal/models';\nimport { PopoverStatus } from '@console/shared';\nimport {\n  SubscriptionModel,\n  CatalogSourceModel,\n  PackageManifestModel,\n  OperatorGroupModel,\n  OperatorHubModel,\n} from '../models';\nimport {\n  CatalogSourceKind,\n  SubscriptionKind,\n  PackageManifestKind,\n  OperatorGroupKind,\n} from '../types';\nimport { requireOperatorGroup } from './operator-group';\nimport { PackageManifestList } from './package-manifest';\nimport { deleteCatalogSourceModal } from './modals/delete-catalog-source-modal';\nimport { disableDefaultSourceModal } from './modals/disable-default-source-modal';\nimport { OperatorHubKind } from './operator-hub';\n\nconst DEFAULT_SOURCE_NAMESPACE = 'openshift-marketplace';\nconst catalogSourceModelReference = referenceForModel(CatalogSourceModel);\n\nconst deleteModal = (kind: K8sKind, catalogSource: CatalogSourceKind): KebabOption => ({\n  ...Kebab.factory.Delete(kind, catalogSource),\n  callback: () => deleteCatalogSourceModal({ kind, resource: catalogSource }),\n});\n\nconst disableSourceModal = (\n  kind: K8sKind,\n  operatorHub: OperatorHubKind,\n  sourceName: string,\n): KebabOption => ({\n  label: 'Disable',\n  callback: () => disableDefaultSourceModal({ kind, operatorHub, sourceName }),\n  accessReview: asAccessReview(kind, operatorHub, 'patch'),\n});\n\nconst enableSource = (\n  kind: K8sKind,\n  operatorHub: OperatorHubKind,\n  sourceName: string,\n): KebabOption => ({\n  label: 'Enable',\n  callback: () => {\n    const currentSources = _.get(operatorHub, 'spec.sources', []);\n    const patch = [\n      {\n        op: 'add',\n        path: '/spec/sources',\n        value: _.filter(currentSources, (source) => source.name !== sourceName),\n      },\n    ];\n    return k8sPatch(kind, operatorHub, patch);\n  },\n  accessReview: asAccessReview(kind, operatorHub, 'patch'),\n});\n\nconst DefaultSourceKebab: React.FC<DefaultSourceKebabProps> = ({\n  kind,\n  operatorHub,\n  sourceName,\n  sourceDisabled,\n}) => {\n  const options = sourceDisabled\n    ? [enableSource(kind, operatorHub, sourceName)]\n    : [disableSourceModal(kind, operatorHub, sourceName)];\n  return <Kebab options={options} />;\n};\n\nexport const CatalogSourceDetails: React.SFC<CatalogSourceDetailsProps> = ({\n  obj,\n  packageManifests,\n  subscriptions,\n  operatorGroups,\n}) => {\n  const toData = <T extends K8sResourceKind>(data: T[]) => ({ loaded: true, data });\n\n  return !_.isEmpty(obj) ? (\n    <div className=\"co-catalog-details co-m-pane\">\n      <div className=\"co-m-pane__body\">\n        <div className=\"col-xs-4\">\n          <dl className=\"co-m-pane__details\">\n            <dt>Name</dt>\n            <dd>{obj.spec.displayName}</dd>\n          </dl>\n        </div>\n        <div className=\"col-xs-4\">\n          <dl className=\"co-m-pane__details\">\n            <dt>Publisher</dt>\n            <dd>{obj.spec.publisher}</dd>\n          </dl>\n        </div>\n      </div>\n      <div className=\"co-m-pane__body\">\n        <SectionHeading text=\"Packages\" />\n        <PackageManifestList\n          loaded\n          data={packageManifests}\n          operatorGroup={toData(operatorGroups)}\n          subscription={toData(subscriptions)}\n        />\n      </div>\n    </div>\n  ) : (\n    <div />\n  );\n};\n\nexport const CatalogSourceDetailsPage: React.SFC<CatalogSourceDetailsPageProps> = (props) => (\n  <DetailsPage\n    {...props}\n    namespace={props.match.params.ns}\n    kind={referenceForModel(CatalogSourceModel)}\n    name={props.match.params.name}\n    pages={[navFactory.details(CatalogSourceDetails), navFactory.editYaml()]}\n    menuActions={Kebab.factory.common}\n    resources={[\n      {\n        kind: referenceForModel(PackageManifestModel),\n        isList: true,\n        namespace: props.match.params.ns,\n        selector: { matchLabels: { catalog: props.match.params.name } },\n        prop: 'packageManifests',\n      },\n      {\n        kind: referenceForModel(SubscriptionModel),\n        isList: true,\n        namespace: props.match.params.ns,\n        prop: 'subscriptions',\n      },\n      {\n        kind: referenceForModel(OperatorGroupModel),\n        isList: true,\n        namespace: props.match.params.ns,\n        prop: 'operatorGroups',\n      },\n    ]}\n  />\n);\n\nexport const CreateSubscriptionYAML: React.SFC<CreateSubscriptionYAMLProps> = (props) => {\n  type CreateProps = {\n    packageManifest: { loaded: boolean; data?: PackageManifestKind };\n    operatorGroup: { loaded: boolean; data?: OperatorGroupKind[] };\n  };\n  const Create = requireOperatorGroup(\n    withFallback<CreateProps>(\n      (createProps) => {\n        if (createProps.packageManifest.loaded && createProps.packageManifest.data) {\n          const pkg = createProps.packageManifest.data;\n          const channel = pkg.status.defaultChannel\n            ? pkg.status.channels.find(({ name }) => name === pkg.status.defaultChannel)\n            : pkg.status.channels[0];\n\n          const template = `\n          apiVersion: ${SubscriptionModel.apiGroup}/${SubscriptionModel.apiVersion}\n          kind: ${SubscriptionModel.kind},\n          metadata:\n            generateName: ${pkg.metadata.name}-\n            namespace: default\n          spec:\n            source: ${new URLSearchParams(props.location.search).get('catalog')}\n            sourceNamespace: ${new URLSearchParams(props.location.search).get('catalogNamespace')}\n            name: ${pkg.metadata.name}\n            startingCSV: ${channel.currentCSV}\n            channel: ${channel.name}\n        `;\n          return (\n            <CreateYAML {...(props as any)} plural={SubscriptionModel.plural} template={template} />\n          );\n        }\n        return <LoadingBox />;\n      },\n      () => (\n        <MsgBox\n          title=\"Package Not Found\"\n          detail=\"Cannot create a Subscription to a non-existent package.\"\n        />\n      ),\n    ),\n  );\n\n  return (\n    <Firehose\n      resources={[\n        {\n          kind: referenceForModel(PackageManifestModel),\n          isList: false,\n          name: new URLSearchParams(props.location.search).get('pkg'),\n          namespace: new URLSearchParams(props.location.search).get('catalogNamespace'),\n          prop: 'packageManifest',\n        },\n        {\n          kind: referenceForModel(OperatorGroupModel),\n          isList: true,\n          namespace: props.match.params.ns,\n          prop: 'operatorGroup',\n        },\n      ]}\n    >\n      {/* FIXME(alecmerdler): Hack because `Firehose` injects props without TypeScript knowing about it */}\n      <Create {...(props as any)} />\n    </Firehose>\n  );\n};\n\nconst tableColumnClasses = [\n  classNames('col-lg-3', 'col-md-3', 'col-sm-4', 'col-xs-6'),\n  classNames('col-lg-2', 'col-md-3', 'col-sm-4', 'col-xs-6'),\n  classNames('col-lg-2', 'col-md-3', 'col-sm-4', 'hidden-xs'),\n  classNames('col-lg-3', 'col-md-3', 'hidden-sm', 'hidden-xs'),\n  classNames('col-lg-2', 'hidden-md', 'hidden-sm', 'hidden-xs'),\n  Kebab.columnClass,\n];\n\nconst CatalogSourceHeader = () => {\n  return [\n    {\n      title: 'Name',\n      sortField: 'name',\n      transforms: [sortable],\n      props: { className: tableColumnClasses[0] },\n    },\n    {\n      title: 'Publisher',\n      sortField: 'publisher',\n      transforms: [sortable],\n      props: { className: tableColumnClasses[1] },\n    },\n    {\n      title: 'Availability',\n      sortField: 'availabilitySort',\n      transforms: [sortable],\n      props: { className: tableColumnClasses[2] },\n    },\n    {\n      title: 'Endpoint',\n      sortField: 'endpoint',\n      transforms: [sortable],\n      props: { className: tableColumnClasses[3] },\n    },\n    {\n      title: '# of Operators',\n      sortField: 'operatorCount',\n      transforms: [sortable],\n      props: { className: tableColumnClasses[4] },\n    },\n    {\n      title: '',\n      props: { className: tableColumnClasses[5] },\n    },\n  ];\n};\n\nconst getEndpoint = (catalogSource: CatalogSourceKind): React.ReactNode => {\n  if (catalogSource.spec.configmap) {\n    return (\n      <ResourceLink\n        kind={referenceForModel(ConfigMapModel)}\n        name={catalogSource.spec.configmap}\n        namespace={catalogSource.metadata.namespace}\n      />\n    );\n  }\n  return catalogSource.spec.image || catalogSource.spec.address;\n};\n\nconst getOperatorCount = (\n  catalogSource: CatalogSourceKind,\n  packageManifests: PackageManifestKind[],\n): number =>\n  _.filter(packageManifests, {\n    status: {\n      catalogSource: catalogSource.metadata.name,\n      catalogSourceNamespace: catalogSource.metadata.namespace,\n    },\n  } as any).length; // Type inferred to prevent Lodash TypeScript error.\n\nconst CatalogSourceTableRow: RowFunction<CatalogSourceTableRowObj> = ({\n  obj: {\n    availability = '-',\n    disabled = false,\n    endpoint = '-',\n    isDefault = false,\n    name,\n    operatorCount = 0,\n    operatorHub,\n    publisher = '-',\n    source,\n  },\n  index,\n  key,\n  style,\n}) => (\n  <TableRow\n    className={disabled && 'catalog-source__table-row--disabled'}\n    id={source ? source.metadata.uid : index}\n    index={index}\n    style={style}\n    trKey={key}\n  >\n    <TableData className={tableColumnClasses[0]}>\n      {source ? (\n        <ResourceLink\n          kind={catalogSourceModelReference}\n          name={source.metadata.name}\n          namespace={source.metadata.namespace}\n          title={source.metadata.name}\n        />\n      ) : (\n        name\n      )}\n    </TableData>\n    <TableData className={tableColumnClasses[1]}>{publisher}</TableData>\n    <TableData className={tableColumnClasses[2]}>{availability}</TableData>\n    <TableData className={tableColumnClasses[3]}>{endpoint}</TableData>\n    <TableData className={tableColumnClasses[4]}>{operatorCount || '-'}</TableData>\n    <TableData className={tableColumnClasses[5]}>\n      {isDefault ? (\n        <DefaultSourceKebab\n          kind={OperatorHubModel}\n          operatorHub={operatorHub}\n          sourceName={name}\n          sourceDisabled={disabled}\n        />\n      ) : (\n        <ResourceKebab\n          actions={[Kebab.factory.Edit, deleteModal]}\n          kind={catalogSourceModelReference}\n          resource={source}\n        />\n      )}\n    </TableData>\n  </TableRow>\n);\n\nconst CatalogSourceList: React.FC<TableProps> = (props) => (\n  <Table\n    {...props}\n    aria-label=\"Catalog Sources\"\n    Header={CatalogSourceHeader}\n    Row={CatalogSourceTableRow}\n  />\n);\n\nconst DisabledPopover: React.FC<DisabledPopoverProps> = ({ operatorHub, sourceName }) => {\n  const [visible, setVisible] = React.useState<boolean>(null);\n  const close = React.useCallback(() => {\n    setVisible(false);\n  }, []);\n  const onClickEnable = React.useCallback(\n    () =>\n      enableSource(OperatorHubModel, operatorHub, sourceName)\n        .callback()\n        .then(close),\n    [close, operatorHub, sourceName],\n  );\n  return (\n    <PopoverStatus title=\"Disabled\" isVisible={visible} shouldClose={close}>\n      <p>\n        Operators provided by this source will not appear in OperatorHub and any operators installed\n        from this source will not receive updates unitl this source is re-enabled.\n      </p>\n      <Button isInline variant=\"link\" onClick={onClickEnable}>\n        Enable source\n      </Button>\n    </PopoverStatus>\n  );\n};\n\nconst flatten = ({\n  catalogSources,\n  operatorHub,\n  packageManifests,\n}: FlattenArgType): CatalogSourceTableRowObj[] => {\n  const defaultSources: CatalogSourceTableRowObj[] = _.map(\n    operatorHub.status.sources,\n    (defaultSource) => {\n      const catalogSource = _.find(catalogSources.data, {\n        metadata: { name: defaultSource.name, namespace: DEFAULT_SOURCE_NAMESPACE },\n      });\n      const catalogSourceExists = !_.isEmpty(catalogSource);\n      return {\n        availability: catalogSourceExists ? (\n          'Cluster wide'\n        ) : (\n          <DisabledPopover operatorHub={operatorHub} sourceName={defaultSource.name} />\n        ),\n        // Add a string value for sorting by availability since React elements can't be sorted.\n        availabilitySort: catalogSourceExists ? 'Cluster wide' : 'Disabled',\n        disabled: !catalogSourceExists,\n        isDefault: true,\n        name: defaultSource.name,\n        namespace: DEFAULT_SOURCE_NAMESPACE,\n        operatorHub,\n        ...(catalogSourceExists && {\n          source: catalogSource,\n          endpoint: getEndpoint(catalogSource),\n          operatorCount: getOperatorCount(catalogSource, packageManifests.data),\n          publisher: catalogSource.spec.publisher,\n        }),\n      };\n    },\n  );\n\n  const customSources: CatalogSourceTableRowObj[] = _.map(catalogSources.data, (source) => ({\n    availability:\n      source.metadata.namespace === DEFAULT_SOURCE_NAMESPACE\n        ? 'Cluster wide'\n        : source.metadata.namespace,\n    endpoint: getEndpoint(source),\n    name: source.metadata.name,\n    namespace: source.metadata.namespace,\n    operatorCount: getOperatorCount(source, packageManifests.data),\n    operatorHub,\n    publisher: source.spec.publisher,\n    source,\n  }));\n\n  return _.unionWith(\n    defaultSources,\n    customSources,\n    (a, b) => a.name === b.name && a.namespace === b.namespace,\n  );\n};\n\nexport const CatalogSourceListPage: React.FC<CatalogSourceListPageProps> = (props) => (\n  <MultiListPage\n    {...props}\n    canCreate\n    createAccessReview={{ model: CatalogSourceModel }}\n    createButtonText=\"Create Catalog Source\"\n    createProps={{ to: `/k8s/cluster/${referenceForModel(CatalogSourceModel)}/~new` }}\n    flatten={(data) => flatten({ operatorHub: props.obj, ...data })}\n    ListComponent={CatalogSourceList}\n    textFilter=\"catalog-source-name\"\n    hideLabelFilter\n    resources={[\n      {\n        isList: true,\n        kind: referenceForModel(PackageManifestModel),\n        prop: 'packageManifests',\n      },\n      {\n        isList: true,\n        kind: catalogSourceModelReference,\n        prop: 'catalogSources',\n      },\n    ]}\n  />\n);\n\ntype CatalogSourceTableRowObj = {\n  availability: React.ReactNode;\n  disabled?: boolean;\n  endpoint?: React.ReactNode;\n  isDefault?: boolean;\n  name: string;\n  namespace: string;\n  publisher?: string;\n  operatorCount?: number;\n  operatorHub: OperatorHubKind;\n  source?: CatalogSourceKind;\n};\n\ntype DefaultSourceKebabProps = {\n  kind: K8sKind;\n  operatorHub: OperatorHubKind;\n  sourceName: string;\n  sourceDisabled: boolean;\n};\n\ntype DisabledPopoverProps = {\n  operatorHub: OperatorHubKind;\n  sourceName: string;\n};\n\ntype FlattenArgType = {\n  catalogSources: { data: CatalogSourceKind[] };\n  packageManifests: { data: PackageManifestKind[] };\n  operatorHub: OperatorHubKind;\n};\n\nexport type CatalogSourceDetailsProps = {\n  obj: CatalogSourceKind;\n  subscriptions: SubscriptionKind[];\n  packageManifests: PackageManifestKind[];\n  operatorGroups: OperatorGroupKind[];\n};\n\nexport type CatalogSourceDetailsPageProps = {\n  match: match<{ ns?: string; name: string }>;\n};\n\nexport type CatalogSourceListPageProps = {\n  obj: K8sResourceKind;\n} & ListPageProps;\n\nexport type CreateSubscriptionYAMLProps = {\n  match: match<{ ns: string; pkgName: string }>;\n  location: Location;\n};\n\nCatalogSourceDetails.displayName = 'CatalogSourceDetails';\nCatalogSourceDetailsPage.displayName = 'CatalogSourceDetailPage';\nCreateSubscriptionYAML.displayName = 'CreateSubscriptionYAML';\n"]}]}