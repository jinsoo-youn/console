{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/object-bucket-claim-page/create-obc.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/object-bucket-claim-page/create-obc.tsx","mtime":1615298458680},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as React from 'react';\nimport { Helmet } from 'react-helmet';\nimport { Link } from 'react-router-dom';\nimport { ButtonBar, history, resourceObjPath, resourcePathFromModel, Firehose, } from '@console/internal/components/utils';\nimport { StorageClassDropdown } from '@console/internal/components/utils/storage-class-dropdown';\nimport { apiVersionForModel, k8sCreate, referenceFor, referenceForModel, } from '@console/internal/module/k8s';\nimport { NooBaaObjectBucketClaimModel, NooBaaBucketClassModel, } from '@console/noobaa-storage-plugin/src/models';\nimport { ActionGroup, Button } from '@patternfly/react-core';\nimport { getName, ResourceDropdown, isObjectSC } from '@console/shared';\nimport { commonReducer, defaultState } from '../object-bucket-page/state';\nimport { OCS_NS, NB_PROVISIONER } from '../../constants';\nimport './create-obc.scss';\nexport const CreateOBCPage = (props) => {\n    var _a, _b, _c;\n    const [state, dispatch] = React.useReducer(commonReducer, defaultState);\n    const namespace = (_b = (_a = props === null || props === void 0 ? void 0 : props.match) === null || _a === void 0 ? void 0 : _a.params) === null || _b === void 0 ? void 0 : _b.ns;\n    const isNoobaa = (_c = state.scProvisioner) === null || _c === void 0 ? void 0 : _c.includes(NB_PROVISIONER);\n    React.useEffect(() => {\n        const obj = {\n            apiVersion: apiVersionForModel(NooBaaObjectBucketClaimModel),\n            kind: NooBaaObjectBucketClaimModel.kind,\n            metadata: {\n                namespace,\n            },\n            spec: {\n                ssl: false,\n            },\n        };\n        if (state.scName) {\n            obj.spec.storageClassName = state.scName;\n        }\n        if (state.name) {\n            obj.metadata.name = state.name;\n            obj.spec.generateBucketName = state.name;\n        }\n        else {\n            obj.metadata.generateName = 'bucketclaim-';\n            obj.spec.generateBucketName = 'bucket-';\n        }\n        if (state.bucketClass && isNoobaa) {\n            obj.spec.additionalConfig = { bucketclass: state.bucketClass };\n        }\n        dispatch({ type: 'setPayload', payload: obj });\n    }, [namespace, state.name, state.scName, state.bucketClass, isNoobaa]);\n    const save = (e) => {\n        e.preventDefault();\n        dispatch({ type: 'setProgress' });\n        k8sCreate(NooBaaObjectBucketClaimModel, state.payload)\n            .then((resource) => {\n            dispatch({ type: 'unsetProgress' });\n            history.push(resourceObjPath(resource, referenceFor(resource)));\n        })\n            .catch((err) => {\n            dispatch({ type: 'setError', message: err.message });\n            dispatch({ type: 'unsetProgress' });\n        });\n    };\n    const onScChange = (sc) => {\n        dispatch({ type: 'setStorage', name: getName(sc) });\n        dispatch({ type: 'setProvisioner', name: sc === null || sc === void 0 ? void 0 : sc.provisioner });\n    };\n    return (React.createElement(\"div\", { className: \"co-m-pane__body co-m-pane__form\" },\n        React.createElement(Helmet, null,\n            React.createElement(\"title\", null, \"Create Object Bucket Claim\")),\n        React.createElement(\"h1\", { className: \"co-m-pane__heading co-m-pane__heading--baseline\" },\n            React.createElement(\"div\", { className: \"co-m-pane__name\" }, \"Create Object Bucket Claim\"),\n            React.createElement(\"div\", { className: \"co-m-pane__heading-link\" },\n                React.createElement(Link, { to: `${resourcePathFromModel(NooBaaObjectBucketClaimModel, null, namespace)}/~new`, replace: true }, \"Edit YAML\"))),\n        React.createElement(\"form\", { className: \"co-m-pane__body-group\", onSubmit: save },\n            React.createElement(\"div\", null,\n                React.createElement(\"div\", { className: \"form-group\" },\n                    React.createElement(\"label\", { className: \"control-label\", htmlFor: \"obc-name\" }, \"Object Bucket Claim Name\"),\n                    React.createElement(\"div\", { className: \"form-group\" },\n                        React.createElement(\"input\", { className: \"pf-c-form-control\", type: \"text\", onChange: (e) => dispatch({ type: 'setName', name: e.currentTarget.value }), placeholder: \"my-object-bucket\", \"aria-describedby\": \"obc-name-help\", id: \"obc-name\", name: \"obcName\", pattern: \"[a-z0-9](?:[-a-z0-9]*[a-z0-9])?\" }),\n                        React.createElement(\"p\", { className: \"help-block\", id: \"obc-name-help\" }, \"If not provided, a generic name will be generated.\")),\n                    React.createElement(\"div\", { className: \"form-group\" },\n                        React.createElement(StorageClassDropdown, { onChange: onScChange, required: true, name: \"storageClass\", hideClassName: \"co-required\", filter: isObjectSC, id: \"sc-dropdown\" }),\n                        React.createElement(\"p\", { className: \"help-block\" }, \"Defines the object-store service and the bucket provisioner.\")),\n                    isNoobaa && (React.createElement(\"div\", { className: \"form-group\" },\n                        React.createElement(\"label\", { className: \"control-label co-required\", htmlFor: \"obc-name\" }, \"Bucket Class\"),\n                        React.createElement(Firehose, { resources: [\n                                {\n                                    isList: true,\n                                    kind: referenceForModel(NooBaaBucketClassModel),\n                                    namespace: OCS_NS,\n                                    prop: 'bucketClass',\n                                },\n                            ] },\n                            React.createElement(ResourceDropdown, { onChange: (sc) => dispatch({ type: 'setBucketClass', name: sc }), dataSelector: ['metadata', 'name'], selectedKey: state.bucketClass, placeholder: \"Select Bucket Class\", dropDownClassName: \"dropdown--full-width\", className: \"nb-create-obc__bc-dropdown\", id: \"bc-dropdown\" })))))),\n            React.createElement(ButtonBar, { errorMessage: state.error, inProgress: state.progress },\n                React.createElement(ActionGroup, { className: \"pf-c-form\" },\n                    React.createElement(Button, { type: \"submit\", variant: \"primary\" }, \"Create\"),\n                    React.createElement(Button, { onClick: history.goBack, type: \"button\", variant: \"secondary\" }, \"Cancel\"))))));\n};\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/object-bucket-claim-page/create-obc.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/object-bucket-claim-page/create-obc.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Helmet } from 'react-helmet';\nimport { match } from 'react-router';\nimport { Link } from 'react-router-dom';\nimport {\n  ButtonBar,\n  history,\n  resourceObjPath,\n  resourcePathFromModel,\n  Firehose,\n} from '@console/internal/components/utils';\nimport { StorageClassDropdown } from '@console/internal/components/utils/storage-class-dropdown';\nimport {\n  apiVersionForModel,\n  k8sCreate,\n  K8sResourceKind,\n  referenceFor,\n  referenceForModel,\n} from '@console/internal/module/k8s';\nimport {\n  NooBaaObjectBucketClaimModel,\n  NooBaaBucketClassModel,\n} from '@console/noobaa-storage-plugin/src/models';\nimport { ActionGroup, Button } from '@patternfly/react-core';\nimport { getName, ResourceDropdown, isObjectSC } from '@console/shared';\nimport { commonReducer, defaultState } from '../object-bucket-page/state';\nimport { OCS_NS, NB_PROVISIONER } from '../../constants';\nimport './create-obc.scss';\n\nexport const CreateOBCPage: React.FC<CreateOBCPageProps> = (props) => {\n  const [state, dispatch] = React.useReducer(commonReducer, defaultState);\n\n  const namespace = props?.match?.params?.ns;\n  const isNoobaa = state.scProvisioner?.includes(NB_PROVISIONER);\n\n  React.useEffect(() => {\n    const obj: K8sResourceKind = {\n      apiVersion: apiVersionForModel(NooBaaObjectBucketClaimModel),\n      kind: NooBaaObjectBucketClaimModel.kind,\n      metadata: {\n        namespace,\n      },\n      spec: {\n        ssl: false,\n      },\n    };\n    if (state.scName) {\n      obj.spec.storageClassName = state.scName;\n    }\n    if (state.name) {\n      obj.metadata.name = state.name;\n      obj.spec.generateBucketName = state.name;\n    } else {\n      obj.metadata.generateName = 'bucketclaim-';\n      obj.spec.generateBucketName = 'bucket-';\n    }\n    if (state.bucketClass && isNoobaa) {\n      obj.spec.additionalConfig = { bucketclass: state.bucketClass };\n    }\n    dispatch({ type: 'setPayload', payload: obj });\n  }, [namespace, state.name, state.scName, state.bucketClass, isNoobaa]);\n\n  const save = (e: React.FormEvent<EventTarget>) => {\n    e.preventDefault();\n    dispatch({ type: 'setProgress' });\n    k8sCreate(NooBaaObjectBucketClaimModel, state.payload)\n      .then((resource) => {\n        dispatch({ type: 'unsetProgress' });\n        history.push(resourceObjPath(resource, referenceFor(resource)));\n      })\n      .catch((err) => {\n        dispatch({ type: 'setError', message: err.message });\n        dispatch({ type: 'unsetProgress' });\n      });\n  };\n\n  const onScChange = (sc) => {\n    dispatch({ type: 'setStorage', name: getName(sc) });\n    dispatch({ type: 'setProvisioner', name: sc?.provisioner });\n  };\n\n  return (\n    <div className=\"co-m-pane__body co-m-pane__form\">\n      <Helmet>\n        <title>Create Object Bucket Claim</title>\n      </Helmet>\n      <h1 className=\"co-m-pane__heading co-m-pane__heading--baseline\">\n        <div className=\"co-m-pane__name\">Create Object Bucket Claim</div>\n        <div className=\"co-m-pane__heading-link\">\n          <Link\n            to={`${resourcePathFromModel(NooBaaObjectBucketClaimModel, null, namespace)}/~new`}\n            replace\n          >\n            Edit YAML\n          </Link>\n        </div>\n      </h1>\n      <form className=\"co-m-pane__body-group\" onSubmit={save}>\n        <div>\n          <div className=\"form-group\">\n            <label className=\"control-label\" htmlFor=\"obc-name\">\n              Object Bucket Claim Name\n            </label>\n            <div className=\"form-group\">\n              <input\n                className=\"pf-c-form-control\"\n                type=\"text\"\n                onChange={(e) => dispatch({ type: 'setName', name: e.currentTarget.value })}\n                placeholder=\"my-object-bucket\"\n                aria-describedby=\"obc-name-help\"\n                id=\"obc-name\"\n                name=\"obcName\"\n                pattern=\"[a-z0-9](?:[-a-z0-9]*[a-z0-9])?\"\n              />\n              <p className=\"help-block\" id=\"obc-name-help\">\n                If not provided, a generic name will be generated.\n              </p>\n            </div>\n            <div className=\"form-group\">\n              <StorageClassDropdown\n                onChange={onScChange}\n                required\n                name=\"storageClass\"\n                hideClassName=\"co-required\"\n                filter={isObjectSC}\n                id=\"sc-dropdown\"\n              />\n              <p className=\"help-block\">\n                Defines the object-store service and the bucket provisioner.\n              </p>\n            </div>\n            {isNoobaa && (\n              <div className=\"form-group\">\n                <label className=\"control-label co-required\" htmlFor=\"obc-name\">\n                  Bucket Class\n                </label>\n                <Firehose\n                  resources={[\n                    {\n                      isList: true,\n                      kind: referenceForModel(NooBaaBucketClassModel),\n                      namespace: OCS_NS,\n                      prop: 'bucketClass',\n                    },\n                  ]}\n                >\n                  <ResourceDropdown\n                    onChange={(sc) => dispatch({ type: 'setBucketClass', name: sc })}\n                    dataSelector={['metadata', 'name']}\n                    selectedKey={state.bucketClass}\n                    placeholder=\"Select Bucket Class\"\n                    dropDownClassName=\"dropdown--full-width\"\n                    className=\"nb-create-obc__bc-dropdown\"\n                    id=\"bc-dropdown\"\n                  />\n                </Firehose>\n              </div>\n            )}\n          </div>\n        </div>\n        <ButtonBar errorMessage={state.error} inProgress={state.progress}>\n          <ActionGroup className=\"pf-c-form\">\n            <Button type=\"submit\" variant=\"primary\">\n              Create\n            </Button>\n            <Button onClick={history.goBack} type=\"button\" variant=\"secondary\">\n              Cancel\n            </Button>\n          </ActionGroup>\n        </ButtonBar>\n      </form>\n    </div>\n  );\n};\n\ntype CreateOBCPageProps = {\n  match: match<{ ns?: string }>;\n};\n"]}]}