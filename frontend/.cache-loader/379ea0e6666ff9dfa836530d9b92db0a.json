{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/activity-card/activity-card.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/activity-card/activity-card.tsx","mtime":1615298458680},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport DashboardCard from '@console/shared/src/components/dashboard/dashboard-card/DashboardCard';\nimport DashboardCardBody from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardBody';\nimport DashboardCardHeader from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardHeader';\nimport DashboardCardTitle from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardTitle';\nimport { EventModel, StatefulSetModel, PodModel } from '@console/internal/models';\nimport ActivityBody, { RecentEventsBody, OngoingActivityBody, } from '@console/shared/src/components/dashboard/activity-card/ActivityBody';\nimport { withDashboardResources, } from '@console/internal/components/dashboard/with-dashboard-resources';\nimport { getResiliencyProgress } from '@console/ceph-storage-plugin/src/utils';\nimport { DATA_RESILIENCE_QUERIES } from '../../queries';\nimport { NooBaaBackingStoreModel, NooBaaBucketClassModel, NooBaaObjectBucketClaimModel, } from '../../models';\nimport './activity-card.scss';\nconst eventsResource = { isList: true, kind: EventModel.kind, prop: 'events' };\nconst isNoobaaEventObject = (event) => {\n    var _a;\n    const eventName = (_a = event === null || event === void 0 ? void 0 : event.involvedObject) === null || _a === void 0 ? void 0 : _a.name;\n    return _.startsWith(eventName, 'noobaa');\n};\nconst noobaaEventsFilter = (event) => {\n    var _a;\n    const eventKind = (_a = event === null || event === void 0 ? void 0 : event.involvedObject) === null || _a === void 0 ? void 0 : _a.kind;\n    const noobaaResources = [\n        NooBaaBackingStoreModel.kind,\n        NooBaaBucketClassModel.kind,\n        NooBaaObjectBucketClaimModel.kind,\n    ];\n    if (eventKind === PodModel.kind || eventKind === StatefulSetModel.kind) {\n        return isNoobaaEventObject(event);\n    }\n    return noobaaResources.includes(eventKind);\n};\nconst RecentEvent = withDashboardResources(({ watchK8sResource, stopWatchK8sResource, resources }) => {\n    React.useEffect(() => {\n        watchK8sResource(eventsResource);\n        return () => {\n            stopWatchK8sResource(eventsResource);\n        };\n    }, [watchK8sResource, stopWatchK8sResource]);\n    return (React.createElement(RecentEventsBody, { events: resources.events, filter: noobaaEventsFilter }));\n});\nconst OngoingActivity = withDashboardResources(({ watchPrometheus, stopWatchPrometheusQuery, prometheusResults }) => {\n    React.useEffect(() => {\n        watchPrometheus(DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY);\n        watchPrometheus(DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY);\n        return () => {\n            stopWatchPrometheusQuery(DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY);\n            stopWatchPrometheusQuery(DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY);\n        };\n    }, [watchPrometheus, stopWatchPrometheusQuery]);\n    const progress = prometheusResults.getIn([\n        DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY,\n        'data',\n    ]);\n    const progressError = prometheusResults.getIn([\n        DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY,\n        'loadError',\n    ]);\n    const eta = prometheusResults.getIn([\n        DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY,\n        'data',\n    ]);\n    const prometheusActivities = [];\n    if (getResiliencyProgress(progress) < 1) {\n        prometheusActivities.push({\n            results: [progress, eta],\n            loader: () => import('./data-resiliency-activity/data-resiliency-activity').then((m) => m.NoobaaDataResiliency),\n        });\n    }\n    return (React.createElement(OngoingActivityBody, { loaded: progress || progressError, prometheusActivities: prometheusActivities }));\n});\nconst ActivityCard = () => (React.createElement(DashboardCard, { gradient: true },\n    React.createElement(DashboardCardHeader, null,\n        React.createElement(DashboardCardTitle, null, \"Activity\")),\n    React.createElement(DashboardCardBody, null,\n        React.createElement(ActivityBody, { className: \"nb-activity-card__body\" },\n            React.createElement(OngoingActivity, null),\n            React.createElement(RecentEvent, null)))));\nexport default ActivityCard;\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/activity-card/activity-card.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/noobaa-storage-plugin/src/components/activity-card/activity-card.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport DashboardCard from '@console/shared/src/components/dashboard/dashboard-card/DashboardCard';\nimport DashboardCardBody from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardBody';\nimport DashboardCardHeader from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardHeader';\nimport DashboardCardTitle from '@console/shared/src/components/dashboard/dashboard-card/DashboardCardTitle';\nimport { EventKind } from '@console/internal/module/k8s';\nimport { FirehoseResource, FirehoseResult } from '@console/internal/components/utils';\nimport { EventModel, StatefulSetModel, PodModel } from '@console/internal/models';\nimport ActivityBody, {\n  RecentEventsBody,\n  OngoingActivityBody,\n} from '@console/shared/src/components/dashboard/activity-card/ActivityBody';\nimport { PrometheusResponse } from '@console/internal/components/graphs';\nimport {\n  DashboardItemProps,\n  withDashboardResources,\n} from '@console/internal/components/dashboard/with-dashboard-resources';\nimport { getResiliencyProgress } from '@console/ceph-storage-plugin/src/utils';\nimport { DATA_RESILIENCE_QUERIES } from '../../queries';\nimport {\n  NooBaaBackingStoreModel,\n  NooBaaBucketClassModel,\n  NooBaaObjectBucketClaimModel,\n} from '../../models';\nimport './activity-card.scss';\n\nconst eventsResource: FirehoseResource = { isList: true, kind: EventModel.kind, prop: 'events' };\n\nconst isNoobaaEventObject = (event: EventKind): boolean => {\n  const eventName: string = event?.involvedObject?.name;\n  return _.startsWith(eventName, 'noobaa');\n};\n\nconst noobaaEventsFilter = (event: EventKind): boolean => {\n  const eventKind: string = event?.involvedObject?.kind;\n  const noobaaResources = [\n    NooBaaBackingStoreModel.kind,\n    NooBaaBucketClassModel.kind,\n    NooBaaObjectBucketClaimModel.kind,\n  ];\n  if (eventKind === PodModel.kind || eventKind === StatefulSetModel.kind) {\n    return isNoobaaEventObject(event);\n  }\n  return noobaaResources.includes(eventKind);\n};\n\nconst RecentEvent = withDashboardResources(\n  ({ watchK8sResource, stopWatchK8sResource, resources }: DashboardItemProps) => {\n    React.useEffect(() => {\n      watchK8sResource(eventsResource);\n      return () => {\n        stopWatchK8sResource(eventsResource);\n      };\n    }, [watchK8sResource, stopWatchK8sResource]);\n    return (\n      <RecentEventsBody\n        events={resources.events as FirehoseResult<EventKind[]>}\n        filter={noobaaEventsFilter}\n      />\n    );\n  },\n);\n\nconst OngoingActivity = withDashboardResources(\n  ({ watchPrometheus, stopWatchPrometheusQuery, prometheusResults }: DashboardItemProps) => {\n    React.useEffect(() => {\n      watchPrometheus(DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY);\n      watchPrometheus(DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY);\n      return () => {\n        stopWatchPrometheusQuery(DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY);\n        stopWatchPrometheusQuery(DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY);\n      };\n    }, [watchPrometheus, stopWatchPrometheusQuery]);\n\n    const progress = prometheusResults.getIn([\n      DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY,\n      'data',\n    ]) as PrometheusResponse;\n    const progressError = prometheusResults.getIn([\n      DATA_RESILIENCE_QUERIES.REBUILD_PROGRESS_QUERY,\n      'loadError',\n    ]);\n\n    const eta = prometheusResults.getIn([\n      DATA_RESILIENCE_QUERIES.REBUILD_TIME_QUERY,\n      'data',\n    ]) as PrometheusResponse;\n\n    const prometheusActivities = [];\n\n    if (getResiliencyProgress(progress) < 1) {\n      prometheusActivities.push({\n        results: [progress, eta],\n        loader: () =>\n          import('./data-resiliency-activity/data-resiliency-activity').then(\n            (m) => m.NoobaaDataResiliency,\n          ),\n      });\n    }\n\n    return (\n      <OngoingActivityBody\n        loaded={progress || progressError}\n        prometheusActivities={prometheusActivities}\n      />\n    );\n  },\n);\n\nconst ActivityCard: React.FC<{}> = () => (\n  <DashboardCard gradient>\n    <DashboardCardHeader>\n      <DashboardCardTitle>Activity</DashboardCardTitle>\n    </DashboardCardHeader>\n    <DashboardCardBody>\n      <ActivityBody className=\"nb-activity-card__body\">\n        <OngoingActivity />\n        <RecentEvent />\n      </ActivityBody>\n    </DashboardCardBody>\n  </DashboardCard>\n);\n\nexport default ActivityCard;\n"]}]}