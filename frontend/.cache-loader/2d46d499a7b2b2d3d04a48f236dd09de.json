{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/public/components/nav/items.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/nav/items.tsx","mtime":1617671837100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { Link } from 'react-router-dom';\nimport * as _ from 'lodash-es';\nimport { NavItem } from '@patternfly/react-core';\nimport { connect } from 'react-redux';\nimport { formatNamespacedRouteForResource } from '@console/shared/src/utils';\nimport { referenceForModel } from '../../module/k8s';\nimport { stripBasePath } from '../utils';\nimport * as plugins from '../../plugins';\nimport { featureReducerName } from '../../reducers/features';\nimport { getActiveNamespace } from '../../reducers/ui';\nexport const matchesPath = (resourcePath, prefix) => resourcePath === prefix || _.startsWith(resourcePath, `${prefix}/`);\nexport const matchesModel = (resourcePath, model) => model && matchesPath(resourcePath, referenceForModel(model));\nexport const stripNS = (href) => {\n    href = stripBasePath(href);\n    return href\n        .replace(/^\\/?k8s\\//, '')\n        .replace(/^\\/?(cluster|all-namespaces|ns\\/[^/]*)/, '')\n        .replace(/^\\//, '');\n};\nexport const ExternalLink = ({ href, name }) => (React.createElement(NavItem, { isActive: false },\n    React.createElement(\"a\", { className: \"pf-c-nav__link\", href: href, target: \"_blank\", rel: \"noopener noreferrer\" },\n        name,\n        React.createElement(\"span\", { className: \"co-external-link\" }))));\nclass NavLink extends React.PureComponent {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars, no-unused-vars\n    static isActive(...args) {\n        throw new Error('not implemented');\n    }\n    get to() {\n        throw new Error('not implemented');\n    }\n    static startsWith(resourcePath, someStrings) {\n        return _.some(someStrings, (s) => resourcePath.startsWith(s));\n    }\n    render() {\n        const { isActive, id, name, tipText, onClick, testID, children, className } = this.props;\n        // onClick is now handled globally by the Nav's onSelect,\n        // however onClick can still be passed if desired in certain cases\n        const itemClasses = classNames(className, { 'pf-m-current': isActive });\n        const linkClasses = classNames('pf-c-nav__link', { 'pf-m-current': isActive });\n        return (React.createElement(NavItem, { className: itemClasses, isActive: isActive },\n            React.createElement(Link, { className: linkClasses, id: id, \"data-test-id\": testID, to: this.to, onClick: onClick, title: tipText },\n                name,\n                children)));\n    }\n}\nNavLink.defaultProps = {\n    required: '',\n    disallowed: '',\n};\nexport class ResourceNSLink extends NavLink {\n    static isActive(props, resourcePath, activeNamespace) {\n        const href = stripNS(formatNamespacedRouteForResource(props.resource, activeNamespace));\n        return matchesPath(resourcePath, href) || matchesModel(resourcePath, props.model);\n    }\n    get to() {\n        const { resource, activeNamespace } = this.props;\n        return formatNamespacedRouteForResource(resource, activeNamespace);\n    }\n}\nexport class ResourceClusterLink extends NavLink {\n    static isActive(props, resourcePath) {\n        return (resourcePath === props.resource ||\n            _.startsWith(resourcePath, `${props.resource}/`) ||\n            matchesModel(resourcePath, props.model));\n    }\n    get to() {\n        return `/k8s/cluster/${this.props.resource}`;\n    }\n}\nexport class HrefLink extends NavLink {\n    static isActive(props, resourcePath) {\n        const noNSHref = stripNS(props.href);\n        return resourcePath === noNSHref || _.startsWith(resourcePath, `${noNSHref}/`);\n    }\n    get to() {\n        return this.props.href;\n    }\n}\nexport class NewTabLink extends React.PureComponent {\n    render() {\n        const { name, type } = this.props;\n        switch (type) {\n            case 'grafana': {\n                const onClick = () => {\n                    var _a;\n                    let ns = localStorage.getItem('bridge/last-namespace-name') === '#ALL_NS#' ? 'all-namespaces' : (_a = localStorage.getItem('bridge/last-namespace-name')) !== null && _a !== void 0 ? _a : 'all-namespaces';\n                    window.open(`${document.location.origin}/api/grafana/d/k8s-namespace/?var-namespace=${ns}`);\n                };\n                return (React.createElement(NavItem, { isActive: false, onClick: onClick },\n                    React.createElement(Link, { to: \"#\", onClick: e => { e.preventDefault(); }, className: \"pf-c-nav__link\" }, name)));\n            }\n            case 'kibana': {\n                const onClick = () => {\n                    window.open(`${document.location.origin}/api/kibana/`);\n                };\n                return (React.createElement(NavItem, { isActive: false, onClick: onClick },\n                    React.createElement(Link, { to: \"#\", onClick: e => { e.preventDefault(); }, className: \"pf-c-nav__link\" }, name)));\n            }\n            case 'kiali': {\n                const onClick = () => {\n                    window.open(`${document.location.origin}/api/kiali/`);\n                };\n                return (React.createElement(NavItem, { isActive: false, onClick: onClick },\n                    React.createElement(Link, { to: \"#\", onClick: e => { e.preventDefault(); }, className: \"pf-c-nav__link\" }, name)));\n            }\n            case 'git': {\n                const onClick = () => {\n                    window.open(window.SERVER_FLAGS.gitlabURL);\n                };\n                return (React.createElement(NavItem, { isActive: false, onClick: onClick },\n                    React.createElement(Link, { to: \"#\", onClick: e => { e.preventDefault(); }, className: \"pf-c-nav__link\" }, name)));\n            }\n            default: {\n            }\n        }\n    }\n}\nexport const createLink = (item, rootNavLink = false) => {\n    if (plugins.isNavItem(item)) {\n        let Component = null;\n        if (plugins.isHrefNavItem(item)) {\n            Component = HrefLink;\n        }\n        if (plugins.isResourceNSNavItem(item)) {\n            Component = ResourceNSLink;\n        }\n        if (plugins.isResourceClusterNavItem(item)) {\n            Component = ResourceClusterLink;\n        }\n        if (Component) {\n            const key = item.properties.componentProps.name;\n            const props = item.properties.componentProps;\n            if (rootNavLink) {\n                return React.createElement(RootNavLink, Object.assign({}, props, { key: key, component: Component }));\n            }\n            return React.createElement(Component, Object.assign({}, props, { key: key }));\n        }\n    }\n    return undefined;\n};\nconst RootNavLink_ = (_a) => {\n    var { canRender, component: Component, isActive, className, children } = _a, props = __rest(_a, [\"canRender\", \"component\", \"isActive\", \"className\", \"children\"]);\n    if (!canRender) {\n        return null;\n    }\n    return (React.createElement(Component, Object.assign({ className: className }, props, { isActive: isActive }), children));\n};\nconst rootNavLinkMapStateToProps = (state, _a) => {\n    var { required, component: Component } = _a, props = __rest(_a, [\"required\", \"component\"]);\n    return ({\n        canRender: required ? _.castArray(required).every((r) => state[featureReducerName].get(r)) : true,\n        activeNamespace: getActiveNamespace(state),\n        isActive: Component.isActive(props, stripNS(state.UI.get('location')), getActiveNamespace(state)),\n    });\n};\nexport const RootNavLink = connect(rootNavLinkMapStateToProps)(RootNavLink_);\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/nav/items.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/public/components/nav/items.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as classNames from 'classnames';\nimport { Link, LinkProps } from 'react-router-dom';\nimport * as _ from 'lodash-es';\nimport { NavItem } from '@patternfly/react-core';\nimport { connect } from 'react-redux';\nimport { formatNamespacedRouteForResource } from '@console/shared/src/utils';\nimport { referenceForModel, K8sKind } from '../../module/k8s';\nimport { stripBasePath } from '../utils';\nimport * as plugins from '../../plugins';\nimport { featureReducerName } from '../../reducers/features';\nimport { RootState } from '../../redux';\nimport { getActiveNamespace } from '../../reducers/ui';\n\nexport const matchesPath = (resourcePath, prefix) =>\n  resourcePath === prefix || _.startsWith(resourcePath, `${prefix}/`);\nexport const matchesModel = (resourcePath, model) =>\n  model && matchesPath(resourcePath, referenceForModel(model));\n\nexport const stripNS = (href) => {\n  href = stripBasePath(href);\n  return href\n    .replace(/^\\/?k8s\\//, '')\n    .replace(/^\\/?(cluster|all-namespaces|ns\\/[^/]*)/, '')\n    .replace(/^\\//, '');\n};\n\nexport const ExternalLink = ({ href, name }) => (\n  <NavItem isActive={false}>\n    <a className=\"pf-c-nav__link\" href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n      {name}\n      <span className=\"co-external-link\" />\n    </a>\n  </NavItem>\n);\n\nclass NavLink<P extends NavLinkProps> extends React.PureComponent<P> {\n  static defaultProps = {\n    required: '',\n    disallowed: '',\n  };\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars, no-unused-vars\n  static isActive(...args): boolean {\n    throw new Error('not implemented');\n  }\n\n  get to(): string {\n    throw new Error('not implemented');\n  }\n\n  static startsWith(resourcePath: string, someStrings: string[]) {\n    return _.some(someStrings, (s) => resourcePath.startsWith(s));\n  }\n\n  render() {\n    const { isActive, id, name, tipText, onClick, testID, children, className } = this.props;\n\n    // onClick is now handled globally by the Nav's onSelect,\n    // however onClick can still be passed if desired in certain cases\n\n    const itemClasses = classNames(className, { 'pf-m-current': isActive });\n    const linkClasses = classNames('pf-c-nav__link', { 'pf-m-current': isActive });\n    return (\n      <NavItem className={itemClasses} isActive={isActive}>\n        <Link\n          className={linkClasses}\n          id={id}\n          data-test-id={testID}\n          to={this.to}\n          onClick={onClick}\n          title={tipText}\n        >\n          {name}\n          {children}\n        </Link>\n      </NavItem>\n    );\n  }\n}\n\nexport class ResourceNSLink extends NavLink<ResourceNSLinkProps> {\n  static isActive(props, resourcePath, activeNamespace) {\n    const href = stripNS(formatNamespacedRouteForResource(props.resource, activeNamespace));\n    return matchesPath(resourcePath, href) || matchesModel(resourcePath, props.model);\n  }\n\n  get to() {\n    const { resource, activeNamespace } = this.props;\n    return formatNamespacedRouteForResource(resource, activeNamespace);\n  }\n}\n\nexport class ResourceClusterLink extends NavLink<ResourceClusterLinkProps> {\n  static isActive(props, resourcePath) {\n    return (\n      resourcePath === props.resource ||\n      _.startsWith(resourcePath, `${props.resource}/`) ||\n      matchesModel(resourcePath, props.model)\n    );\n  }\n\n  get to() {\n    return `/k8s/cluster/${this.props.resource}`;\n  }\n}\n\nexport class HrefLink extends NavLink<HrefLinkProps> {\n  static isActive(props, resourcePath) {\n    const noNSHref = stripNS(props.href);\n    return resourcePath === noNSHref || _.startsWith(resourcePath, `${noNSHref}/`);\n  }\n\n  get to() {\n    return this.props.href;\n  }\n}\n\nexport class NewTabLink<P extends NewTabLinkProps> extends React.PureComponent<P> {\n  render() {\n    const { name, type } = this.props;\n    switch (type) {\n      case 'grafana': {\n        const onClick = () => {\n          let ns = localStorage.getItem('bridge/last-namespace-name') === '#ALL_NS#' ? 'all-namespaces' : localStorage.getItem('bridge/last-namespace-name') ?? 'all-namespaces';\n          window.open(`${document.location.origin}/api/grafana/d/k8s-namespace/?var-namespace=${ns}`);\n        };\n        return (\n          <NavItem isActive={false} onClick={onClick}>\n            <Link to=\"#\" onClick={e => {e.preventDefault();}} className=\"pf-c-nav__link\">{name}</Link>\n          </NavItem>\n        );\n      }\n\n      case 'kibana': {\n        const onClick = () => {\n          window.open(`${document.location.origin}/api/kibana/`);\n        };\n        return (\n          <NavItem isActive={false} onClick={onClick}>\n            <Link to=\"#\" onClick={e => {e.preventDefault();}} className=\"pf-c-nav__link\">{name}</Link>\n          </NavItem>\n        );\n      }\n\n      case 'kiali': {\n        const onClick = () => {\n          window.open(`${document.location.origin}/api/kiali/`);\n        };\n        return (\n          <NavItem isActive={false} onClick={onClick}>\n            <Link to=\"#\" onClick={e => {e.preventDefault();}} className=\"pf-c-nav__link\">{name}</Link>\n          </NavItem>\n        );\n      }\n\n      case 'git': {\n        const onClick = () => {\n          window.open(window.SERVER_FLAGS.gitlabURL);\n        };\n        return (\n          <NavItem isActive={false} onClick={onClick}>\n            <Link to=\"#\" onClick={e => {e.preventDefault();}} className=\"pf-c-nav__link\">{name}</Link>\n          </NavItem>\n        );\n      }\n      default: {\n      }\n    }\n  }\n}\n\nexport type NavLinkProps = {\n  name: string;\n  id?: LinkProps['id'];\n  className?: string;\n  onClick?: LinkProps['onClick'];\n  isActive?: boolean;\n  required?: string | string[];\n  disallowed?: string;\n  startsWith?: string[];\n  activePath?: string;\n  tipText?: string;\n  testID?: string;\n};\n\nexport type ResourceNSLinkProps = NavLinkProps & {\n  resource: string;\n  model?: K8sKind;\n  activeNamespace?: string;\n};\n\nexport type ResourceClusterLinkProps = NavLinkProps & {\n  resource: string;\n  model?: K8sKind;\n};\n\nexport type HrefLinkProps = NavLinkProps & {\n  href: string;\n};\n\nexport type NewTabLinkProps = NavLinkProps & {\n  name: string;\n  type: string;\n};\n\nexport type NavLinkComponent<T extends NavLinkProps = NavLinkProps> = React.ComponentType<T> & {\n  isActive: (props: T, resourcePath: string, activeNamespace: string) => boolean;\n};\n\nexport const createLink = (item: plugins.NavItem, rootNavLink = false): React.ReactElement => {\n  if (plugins.isNavItem(item)) {\n    let Component: NavLinkComponent = null;\n    if (plugins.isHrefNavItem(item)) {\n      Component = HrefLink;\n    }\n    if (plugins.isResourceNSNavItem(item)) {\n      Component = ResourceNSLink;\n    }\n    if (plugins.isResourceClusterNavItem(item)) {\n      Component = ResourceClusterLink;\n    }\n    if (Component) {\n      const key = item.properties.componentProps.name;\n      const props = item.properties.componentProps;\n      if (rootNavLink) {\n        return <RootNavLink {...props} key={key} component={Component} />;\n      }\n      return <Component {...props} key={key} />;\n    }\n  }\n  return undefined;\n};\n\ntype RootNavLinkStateProps = {\n  canRender: boolean;\n  isActive: boolean;\n  activeNamespace: string;\n};\n\ntype RootNavLinkProps<T extends NavLinkProps = NavLinkProps> = NavLinkProps & {\n  component: NavLinkComponent<T>;\n};\n\nconst RootNavLink_: React.FC<RootNavLinkProps & RootNavLinkStateProps> = ({\n  canRender,\n  component: Component,\n  isActive,\n  className,\n  children,\n  ...props\n}) => {\n  if (!canRender) {\n    return null;\n  }\n  return (\n    <Component className={className} {...props} isActive={isActive}>\n      {children}\n    </Component>\n  );\n};\n\nconst rootNavLinkMapStateToProps = (\n  state: RootState,\n  { required, component: Component, ...props }: RootNavLinkProps,\n): RootNavLinkStateProps => ({\n  canRender: required ? _.castArray(required).every((r) => state[featureReducerName].get(r)) : true,\n  activeNamespace: getActiveNamespace(state),\n  isActive: Component.isActive(props, stripNS(state.UI.get('location')), getActiveNamespace(state)),\n});\n\nexport const RootNavLink = connect(rootNavLinkMapStateToProps)(RootNavLink_);\n"]}]}