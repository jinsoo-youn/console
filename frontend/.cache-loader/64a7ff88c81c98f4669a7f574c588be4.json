{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/ceph-storage-plugin/src/plugin.ts","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/ceph-storage-plugin/src/plugin.ts","mtime":1615298458590},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as _ from 'lodash';\nimport * as models from './models';\nimport { detectOCS, detectOCSSupportedFeatures, CEPH_FLAG, OCS_INDEPENDENT_FLAG, OCS_SUPPORT_FLAGS, OCS_CONVERGED_FLAG, } from './features';\nimport { ClusterServiceVersionModel } from '@console/operator-lifecycle-manager/src/models';\nimport { GridPosition } from '@console/shared/src/components/dashboard/DashboardGrid';\nimport { referenceForModel, referenceFor } from '@console/internal/module/k8s';\nimport { PersistentVolumeClaimModel } from '@console/internal/models';\nimport { getCephHealthState } from './components/dashboard-page/storage-dashboard/status-card/utils';\nimport { isClusterExpandActivity } from './components/dashboard-page/storage-dashboard/activity-card/cluster-expand-activity';\nconst apiObjectRef = referenceForModel(models.OCSServiceModel);\nconst plugin = [\n    {\n        type: 'ModelDefinition',\n        properties: {\n            models: _.values(models),\n        },\n    },\n    {\n        type: 'FeatureFlag/Model',\n        properties: {\n            model: models.OCSServiceModel,\n            flag: CEPH_FLAG,\n        },\n    },\n    {\n        type: 'FeatureFlag/Custom',\n        properties: {\n            detect: detectOCSSupportedFeatures,\n        },\n    },\n    {\n        type: 'FeatureFlag/Custom',\n        properties: {\n            detect: detectOCS,\n        },\n    },\n    {\n        type: 'Page/Resource/Tab',\n        properties: {\n            href: 'volumesnapshots',\n            model: PersistentVolumeClaimModel,\n            name: 'Volume Snapshots',\n            loader: () => import('./components/volume-snapshot/volume-snapshot').then((m) => m.VolumeSnapshotPage) /* webpackChunkName: \"ceph-storage-volume-snapshot\" */,\n        },\n        flags: {\n            required: [OCS_SUPPORT_FLAGS.SNAPSHOT, CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Tab',\n        properties: {\n            id: 'persistent-storage',\n            title: 'Persistent Storage',\n        },\n        flags: {\n            required: [OCS_CONVERGED_FLAG],\n            disallowed: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Page/Route',\n        properties: {\n            exact: true,\n            path: `/k8s/ns/:ns/${ClusterServiceVersionModel.plural}/:appName/${apiObjectRef}/~new`,\n            loader: () => import('./components/ocs-install/install-page' /* webpackChunkName: \"install-page\" */).then((m) => m.default),\n        },\n    },\n    // Ceph Storage Dashboard Left cards\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.LEFT,\n            loader: () => import('./components/dashboard-page/storage-dashboard/details-card' /* webpackChunkName: \"ceph-storage-details-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.LEFT,\n            loader: () => import('./components/dashboard-page/storage-dashboard/inventory-card' /* webpackChunkName: \"ceph-storage-inventory-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    // Ceph Storage Dashboard Main Cards\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/dashboard-page/storage-dashboard/status-card/status-card' /* webpackChunkName: \"ceph-storage-status-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/dashboard-page/storage-dashboard/capacity-breakdown/capacity-breakdown-card' /* webpackChunkName: \"ceph-storage-usage-breakdown-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/dashboard-page/storage-dashboard/utilization-card/utilization-card' /* webpackChunkName: \"ceph-storage-utilization-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    // Ceph Storage Dashboard Right Cards\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'persistent-storage',\n            position: GridPosition.RIGHT,\n            loader: () => import('./components/dashboard-page/storage-dashboard/activity-card/activity-card' /* webpackChunkName: \"ceph-storage-activity-card\" */).then((m) => m.ActivityCard),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Overview/Health/Resource',\n        properties: {\n            title: 'Storage',\n            resources: {\n                ceph: {\n                    kind: referenceForModel(models.CephClusterModel),\n                    namespaced: false,\n                    isList: true,\n                },\n            },\n            healthHandler: getCephHealthState,\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n    {\n        type: 'ClusterServiceVersion/Action',\n        properties: {\n            kind: 'StorageCluster',\n            label: 'Add Capacity',\n            apiGroup: models.OCSServiceModel.apiGroup,\n            callback: (kind, ocsConfig) => () => {\n                const clusterObject = { ocsConfig };\n                import('./components/modals/add-capacity-modal/add-capacity-modal' /* webpackChunkName: \"ceph-storage-add-capacity-modal\" */)\n                    .then((m) => m.addCapacityModal(clusterObject))\n                    .catch((e) => {\n                    throw e;\n                });\n            },\n            disallowed: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    // Download External Cluster Metadata\n    {\n        type: 'ClusterServiceVersion/Action',\n        properties: {\n            kind: 'StorageCluster',\n            label: 'Download Cluster Metadata',\n            apiGroup: models.OCSServiceModel.apiGroup,\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            callback: (_kind, _obj) => () => import('./components/converged-credentials/credentials' /* webpackChunkName: \"ceph-storage-export-credentials\" */).then((m) => m.default({})),\n            disallowed: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Tab',\n        properties: {\n            id: 'independent-dashboard',\n            title: 'Persistent Storage',\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    // Left Cards\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.LEFT,\n            loader: () => import('./components/independent-dashboard-page/details-card/card' /* webpackChunkName: \"indepedent-details-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.LEFT,\n            loader: () => import('./components/dashboard-page/storage-dashboard/inventory-card' /* webpackChunkName: \"ceph-storage-inventory-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    // Center\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/independent-dashboard-page/status-card/card' /* webpackChunkName: \"indepedent-status-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/independent-dashboard-page/breakdown-card/card' /* webpackChunkName: \"independent-breakdown-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.MAIN,\n            loader: () => import('./components/independent-dashboard-page/utilization-card/card' /* webpackChunkName: \"utilization-card\" */).then((m) => m.default),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    // Right\n    {\n        type: 'Dashboards/Card',\n        properties: {\n            tab: 'independent-dashboard',\n            position: GridPosition.RIGHT,\n            loader: () => import('./components/dashboard-page/storage-dashboard/activity-card/activity-card' /* webpackChunkName: \"ceph-storage-activity-card\" */).then((m) => m.ActivityCard),\n        },\n        flags: {\n            required: [OCS_INDEPENDENT_FLAG],\n        },\n    },\n    {\n        type: 'Page/Resource/Details',\n        properties: {\n            model: models.VolumeSnapshotModel,\n            loader: () => __awaiter(void 0, void 0, void 0, function* () {\n                return import('./components/volume-snapshot/volume-snapshot' /* webpackChunkName: \"ceph-storage-volume-snapshot-details\" */).then((m) => m.VolumeSnapshotDetails);\n            }),\n            modelParser: referenceFor,\n        },\n        flags: {\n            required: [OCS_SUPPORT_FLAGS.SNAPSHOT, CEPH_FLAG],\n        },\n    },\n    {\n        type: 'Dashboards/Overview/Activity/Resource',\n        properties: {\n            k8sResource: {\n                isList: true,\n                kind: referenceForModel(models.OCSServiceModel),\n                namespaced: false,\n                prop: 'storage-cluster',\n            },\n            isActivity: isClusterExpandActivity,\n            loader: () => import('./components/dashboard-page/storage-dashboard/activity-card/cluster-expand-activity' /* webpackChunkName: \"ceph-storage-plugin\" */).then((m) => m.ClusterExpandActivity),\n        },\n        flags: {\n            required: [CEPH_FLAG],\n        },\n    },\n];\nexport default plugin;\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/ceph-storage-plugin/src/plugin.ts","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/ceph-storage-plugin/src/plugin.ts"],"names":[],"mappings":"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","sourcesContent":["import * as _ from 'lodash';\nimport * as models from './models';\nimport {\n  ClusterServiceVersionAction,\n  DashboardsCard,\n  DashboardsOverviewHealthResourceSubsystem,\n  DashboardsOverviewUtilizationItem,\n  DashboardsTab,\n  KebabActions,\n  ModelDefinition,\n  ModelFeatureFlag,\n  Plugin,\n  ResourceTabPage,\n  RoutePage,\n  ResourceDetailsPage,\n  DashboardsOverviewResourceActivity,\n  CustomFeatureFlag,\n} from '@console/plugin-sdk';\nimport {\n  detectOCS,\n  detectOCSSupportedFeatures,\n  CEPH_FLAG,\n  OCS_INDEPENDENT_FLAG,\n  OCS_SUPPORT_FLAGS,\n  OCS_CONVERGED_FLAG,\n} from './features';\nimport { ClusterServiceVersionModel } from '@console/operator-lifecycle-manager/src/models';\nimport { GridPosition } from '@console/shared/src/components/dashboard/DashboardGrid';\nimport { referenceForModel, referenceFor } from '@console/internal/module/k8s';\nimport { PersistentVolumeClaimModel } from '@console/internal/models';\nimport { getCephHealthState } from './components/dashboard-page/storage-dashboard/status-card/utils';\nimport { isClusterExpandActivity } from './components/dashboard-page/storage-dashboard/activity-card/cluster-expand-activity';\nimport { WatchCephResource } from './types';\n\ntype ConsumedExtensions =\n  | ModelFeatureFlag\n  | ModelDefinition\n  | DashboardsTab\n  | DashboardsCard\n  | DashboardsOverviewHealthResourceSubsystem<WatchCephResource>\n  | DashboardsOverviewUtilizationItem\n  | RoutePage\n  | CustomFeatureFlag\n  | ClusterServiceVersionAction\n  | KebabActions\n  | ResourceDetailsPage\n  | ResourceTabPage\n  | ClusterServiceVersionAction\n  | KebabActions\n  | DashboardsOverviewResourceActivity;\n\nconst apiObjectRef = referenceForModel(models.OCSServiceModel);\n\nconst plugin: Plugin<ConsumedExtensions> = [\n  {\n    type: 'ModelDefinition',\n    properties: {\n      models: _.values(models),\n    },\n  },\n  {\n    type: 'FeatureFlag/Model',\n    properties: {\n      model: models.OCSServiceModel,\n      flag: CEPH_FLAG,\n    },\n  },\n  {\n    type: 'FeatureFlag/Custom',\n    properties: {\n      detect: detectOCSSupportedFeatures,\n    },\n  },\n  {\n    type: 'FeatureFlag/Custom',\n    properties: {\n      detect: detectOCS,\n    },\n  },\n  {\n    type: 'Page/Resource/Tab',\n    properties: {\n      href: 'volumesnapshots',\n      model: PersistentVolumeClaimModel,\n      name: 'Volume Snapshots',\n      loader: () =>\n        import('./components/volume-snapshot/volume-snapshot').then(\n          (m) => m.VolumeSnapshotPage,\n        ) /* webpackChunkName: \"ceph-storage-volume-snapshot\" */,\n    },\n    flags: {\n      required: [OCS_SUPPORT_FLAGS.SNAPSHOT, CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Tab',\n    properties: {\n      id: 'persistent-storage',\n      title: 'Persistent Storage',\n    },\n    flags: {\n      required: [OCS_CONVERGED_FLAG],\n      disallowed: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Page/Route',\n    properties: {\n      exact: true,\n      path: `/k8s/ns/:ns/${ClusterServiceVersionModel.plural}/:appName/${apiObjectRef}/~new`,\n      loader: () =>\n        import('./components/ocs-install/install-page' /* webpackChunkName: \"install-page\" */).then(\n          (m) => m.default,\n        ),\n    },\n  },\n  // Ceph Storage Dashboard Left cards\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.LEFT,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/details-card' /* webpackChunkName: \"ceph-storage-details-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.LEFT,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/inventory-card' /* webpackChunkName: \"ceph-storage-inventory-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  // Ceph Storage Dashboard Main Cards\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/status-card/status-card' /* webpackChunkName: \"ceph-storage-status-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/capacity-breakdown/capacity-breakdown-card' /* webpackChunkName: \"ceph-storage-usage-breakdown-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/utilization-card/utilization-card' /* webpackChunkName: \"ceph-storage-utilization-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  // Ceph Storage Dashboard Right Cards\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'persistent-storage',\n      position: GridPosition.RIGHT,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/activity-card/activity-card' /* webpackChunkName: \"ceph-storage-activity-card\" */\n        ).then((m) => m.ActivityCard),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Overview/Health/Resource',\n    properties: {\n      title: 'Storage',\n      resources: {\n        ceph: {\n          kind: referenceForModel(models.CephClusterModel),\n          namespaced: false,\n          isList: true,\n        },\n      },\n      healthHandler: getCephHealthState,\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n  {\n    type: 'ClusterServiceVersion/Action',\n    properties: {\n      kind: 'StorageCluster',\n      label: 'Add Capacity',\n      apiGroup: models.OCSServiceModel.apiGroup,\n      callback: (kind, ocsConfig) => () => {\n        const clusterObject = { ocsConfig };\n        import(\n          './components/modals/add-capacity-modal/add-capacity-modal' /* webpackChunkName: \"ceph-storage-add-capacity-modal\" */\n        )\n          .then((m) => m.addCapacityModal(clusterObject))\n          .catch((e) => {\n            throw e;\n          });\n      },\n      disallowed: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  // Download External Cluster Metadata\n  {\n    type: 'ClusterServiceVersion/Action',\n    properties: {\n      kind: 'StorageCluster',\n      label: 'Download Cluster Metadata',\n      apiGroup: models.OCSServiceModel.apiGroup,\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      callback: (_kind, _obj) => () =>\n        import(\n          './components/converged-credentials/credentials' /* webpackChunkName: \"ceph-storage-export-credentials\" */\n        ).then((m) => m.default({})),\n      disallowed: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Tab',\n    properties: {\n      id: 'independent-dashboard',\n      title: 'Persistent Storage',\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  // Left Cards\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.LEFT,\n      loader: () =>\n        import(\n          './components/independent-dashboard-page/details-card/card' /* webpackChunkName: \"indepedent-details-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.LEFT,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/inventory-card' /* webpackChunkName: \"ceph-storage-inventory-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  // Center\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/independent-dashboard-page/status-card/card' /* webpackChunkName: \"indepedent-status-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/independent-dashboard-page/breakdown-card/card' /* webpackChunkName: \"independent-breakdown-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.MAIN,\n      loader: () =>\n        import(\n          './components/independent-dashboard-page/utilization-card/card' /* webpackChunkName: \"utilization-card\" */\n        ).then((m) => m.default),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  // Right\n  {\n    type: 'Dashboards/Card',\n    properties: {\n      tab: 'independent-dashboard',\n      position: GridPosition.RIGHT,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/activity-card/activity-card' /* webpackChunkName: \"ceph-storage-activity-card\" */\n        ).then((m) => m.ActivityCard),\n    },\n    flags: {\n      required: [OCS_INDEPENDENT_FLAG],\n    },\n  },\n  {\n    type: 'Page/Resource/Details',\n    properties: {\n      model: models.VolumeSnapshotModel,\n      loader: async () =>\n        import(\n          './components/volume-snapshot/volume-snapshot' /* webpackChunkName: \"ceph-storage-volume-snapshot-details\" */\n        ).then((m) => m.VolumeSnapshotDetails),\n      modelParser: referenceFor,\n    },\n    flags: {\n      required: [OCS_SUPPORT_FLAGS.SNAPSHOT, CEPH_FLAG],\n    },\n  },\n  {\n    type: 'Dashboards/Overview/Activity/Resource',\n    properties: {\n      k8sResource: {\n        isList: true,\n        kind: referenceForModel(models.OCSServiceModel),\n        namespaced: false,\n        prop: 'storage-cluster',\n      },\n      isActivity: isClusterExpandActivity,\n      loader: () =>\n        import(\n          './components/dashboard-page/storage-dashboard/activity-card/cluster-expand-activity' /* webpackChunkName: \"ceph-storage-plugin\" */\n        ).then((m) => m.ClusterExpandActivity),\n    },\n    flags: {\n      required: [CEPH_FLAG],\n    },\n  },\n];\n\nexport default plugin;\n"]}]}