{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/public/components/graphs/area.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/graphs/area.tsx","mtime":1616735742470},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport * as React from 'react';\nimport { Chart, ChartArea, ChartAxis, ChartThemeColor, ChartThemeVariant, ChartVoronoiContainer, getCustomTheme, ChartGroup, ChartTooltip, } from '@patternfly/react-charts';\nimport { global_warning_color_100 as warningColor, global_danger_color_100 as dangerColor, } from '@patternfly/react-tokens';\nimport { processFrame } from '@console/shared/src/graph-helper/data-utils';\nimport { twentyFourHourTime } from '../utils/datetime';\nimport { humanizeNumber, useRefWidth } from '../utils';\nimport { PrometheusEndpoint } from './helpers';\nimport { PrometheusGraph, PrometheusGraphLink } from './prometheus-graph';\nimport { usePrometheusPoll } from './prometheus-poll-hook';\nimport { areaTheme } from './themes';\nimport { getRangeVectorStats } from './utils';\nimport { GraphEmpty } from './graph-empty';\nconst DEFAULT_HEIGHT = 180;\nconst DEFAULT_SAMPLES = 60;\nconst DEFAULT_TICK_COUNT = 3;\nconst DEFAULT_TIMESPAN = 60 * 60 * 1000; // 1 hour\nexport var AreaChartStatus;\n(function (AreaChartStatus) {\n    AreaChartStatus[\"ERROR\"] = \"ERROR\";\n    AreaChartStatus[\"WARNING\"] = \"WARNING\";\n})(AreaChartStatus || (AreaChartStatus = {}));\nexport const chartStatusColors = {\n    [AreaChartStatus.ERROR]: dangerColor.value,\n    [AreaChartStatus.WARNING]: warningColor.value,\n};\nexport const AreaChart = ({ className, data = [], formatDate = twentyFourHourTime, height = DEFAULT_HEIGHT, humanize = humanizeNumber, loading = true, padding, query, theme = getCustomTheme(ChartThemeColor.blue, ChartThemeVariant.light, areaTheme), tickCount = DEFAULT_TICK_COUNT, title, xAxis = true, yAxis = true, chartStyle, byteDataType = '', }) => {\n    const [containerRef, width] = useRefWidth();\n    const [processedData, setProcessedData] = React.useState(data);\n    const [unit, setUnit] = React.useState('');\n    React.useEffect(() => {\n        if (byteDataType) {\n            const result = processFrame(data, byteDataType);\n            setProcessedData(result.processedData);\n            setUnit(result.unit);\n        }\n        else {\n            setProcessedData(data);\n        }\n    }, [byteDataType, data]);\n    const tickFormat = React.useCallback((tick) => `${humanize(tick, unit, unit).string}`, [\n        humanize,\n        unit,\n    ]);\n    const getLabel = React.useCallback((prop) => {\n        const { x, y, description } = prop.datum;\n        const value = humanize(y, unit, unit).string;\n        const date = formatDate(x);\n        if (!description) {\n            return `${value} at ${date}`;\n        }\n        return description(date, value);\n    }, [humanize, unit, formatDate]);\n    const multiLine = data && data.filter((d) => !!d).length > 1;\n    const container = (React.createElement(ChartVoronoiContainer, { voronoiDimension: \"x\", labels: getLabel, activateData: false, labelComponent: React.createElement(ChartTooltip, { centerOffset: multiLine ? { x: 0, y: -40 } : undefined, pointerLength: multiLine ? 40 : undefined }) }));\n    return (React.createElement(PrometheusGraph, { className: className, ref: containerRef, title: title }, data && data[0] && data[0].length ? (React.createElement(PrometheusGraphLink, { query: query },\n        React.createElement(Chart, { containerComponent: container, domainPadding: { y: 20 }, height: height, width: width, theme: theme, scale: { x: 'time', y: 'linear' }, padding: padding },\n            xAxis && React.createElement(ChartAxis, { tickCount: tickCount, tickFormat: formatDate }),\n            yAxis && React.createElement(ChartAxis, { dependentAxis: true, tickCount: tickCount, tickFormat: tickFormat }),\n            React.createElement(ChartGroup, null, processedData.map((datum, index) => (React.createElement(ChartArea, { key: index, data: datum, style: chartStyle && chartStyle[index] }))))))) : (React.createElement(GraphEmpty, { height: height, loading: loading }))));\n};\nexport const Area = (_a) => {\n    var { namespace, query, samples = DEFAULT_SAMPLES, timeout, timespan = DEFAULT_TIMESPAN } = _a, rest = __rest(_a, [\"namespace\", \"query\", \"samples\", \"timeout\", \"timespan\"]);\n    const [response, , loading] = usePrometheusPoll({\n        endpoint: PrometheusEndpoint.QUERY_RANGE,\n        namespace,\n        query,\n        samples,\n        timeout,\n        timespan,\n    });\n    const data = getRangeVectorStats(response);\n    return React.createElement(AreaChart, Object.assign({ data: [data], loading: loading, query: query }, rest));\n};\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/public/components/graphs/area.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/public/components/graphs/area.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Chart,\n  ChartArea,\n  ChartAxis,\n  ChartThemeColor,\n  ChartThemeVariant,\n  ChartVoronoiContainer,\n  getCustomTheme,\n  ChartGroup,\n  ChartTooltip,\n} from '@patternfly/react-charts';\nimport {\n  global_warning_color_100 as warningColor,\n  global_danger_color_100 as dangerColor,\n} from '@patternfly/react-tokens';\nimport { processFrame, ByteDataTypes } from '@console/shared/src/graph-helper/data-utils';\nimport { twentyFourHourTime } from '../utils/datetime';\nimport { humanizeNumber, useRefWidth, Humanize } from '../utils';\nimport { PrometheusEndpoint } from './helpers';\nimport { PrometheusGraph, PrometheusGraphLink } from './prometheus-graph';\nimport { usePrometheusPoll } from './prometheus-poll-hook';\nimport { areaTheme } from './themes';\nimport { DataPoint } from './';\nimport { getRangeVectorStats } from './utils';\nimport { GraphEmpty } from './graph-empty';\n\nconst DEFAULT_HEIGHT = 180;\nconst DEFAULT_SAMPLES = 60;\nconst DEFAULT_TICK_COUNT = 3;\nconst DEFAULT_TIMESPAN = 60 * 60 * 1000; // 1 hour\n\nexport enum AreaChartStatus {\n  ERROR = 'ERROR',\n  WARNING = 'WARNING',\n}\n\nexport const chartStatusColors = {\n  [AreaChartStatus.ERROR]: dangerColor.value,\n  [AreaChartStatus.WARNING]: warningColor.value,\n};\n\nexport const AreaChart: React.FC<AreaChartProps> = ({\n  className,\n  data = [],\n  formatDate = twentyFourHourTime,\n  height = DEFAULT_HEIGHT,\n  humanize = humanizeNumber,\n  loading = true,\n  padding,\n  query,\n  theme = getCustomTheme(ChartThemeColor.blue, ChartThemeVariant.light, areaTheme),\n  tickCount = DEFAULT_TICK_COUNT,\n  title,\n  xAxis = true,\n  yAxis = true,\n  chartStyle,\n  byteDataType = '',\n}) => {\n  const [containerRef, width] = useRefWidth();\n  const [processedData, setProcessedData] = React.useState(data);\n  const [unit, setUnit] = React.useState('');\n\n  React.useEffect(() => {\n    if (byteDataType) {\n      const result = processFrame(data, byteDataType);\n      setProcessedData(result.processedData);\n      setUnit(result.unit);\n    } else {\n      setProcessedData(data);\n    }\n  }, [byteDataType, data]);\n\n  const tickFormat = React.useCallback((tick) => `${humanize(tick, unit, unit).string}`, [\n    humanize,\n    unit,\n  ]);\n\n  const getLabel = React.useCallback(\n    (prop) => {\n      const { x, y, description } = prop.datum as DataPoint<Date>;\n      const value = humanize(y, unit, unit).string;\n      const date = formatDate(x);\n      if (!description) {\n        return `${value} at ${date}`;\n      }\n      return description(date, value);\n    },\n    [humanize, unit, formatDate],\n  );\n\n  const multiLine = data && data.filter((d) => !!d).length > 1;\n\n  const container = (\n    <ChartVoronoiContainer\n      voronoiDimension=\"x\"\n      labels={getLabel}\n      activateData={false}\n      labelComponent={\n        <ChartTooltip\n          centerOffset={multiLine ? { x: 0, y: -40 } : undefined}\n          pointerLength={multiLine ? 40 : undefined}\n        />\n      }\n    />\n  );\n\n  return (\n    <PrometheusGraph className={className} ref={containerRef} title={title}>\n      {data && data[0] && data[0].length ? (\n        <PrometheusGraphLink query={query}>\n          <Chart\n            containerComponent={container}\n            domainPadding={{ y: 20 }}\n            height={height}\n            width={width}\n            theme={theme}\n            scale={{ x: 'time', y: 'linear' }}\n            padding={padding}\n          >\n            {xAxis && <ChartAxis tickCount={tickCount} tickFormat={formatDate} />}\n            {yAxis && <ChartAxis dependentAxis tickCount={tickCount} tickFormat={tickFormat} />}\n            <ChartGroup>\n              {processedData.map((datum, index) => (\n                <ChartArea key={index} data={datum} style={chartStyle && chartStyle[index]} />\n              ))}\n            </ChartGroup>\n          </Chart>\n        </PrometheusGraphLink>\n      ) : (\n        <GraphEmpty height={height} loading={loading} />\n      )}\n    </PrometheusGraph>\n  );\n};\n\nexport const Area: React.FC<AreaProps> = ({\n  namespace,\n  query,\n  samples = DEFAULT_SAMPLES,\n  timeout,\n  timespan = DEFAULT_TIMESPAN,\n  ...rest\n}) => {\n  const [response, , loading] = usePrometheusPoll({\n    endpoint: PrometheusEndpoint.QUERY_RANGE,\n    namespace,\n    query,\n    samples,\n    timeout,\n    timespan,\n  });\n  const data = getRangeVectorStats(response);\n  return <AreaChart data={[data]} loading={loading} query={query} {...rest} />;\n};\n\ntype AreaChartProps = {\n  className?: string;\n  formatDate?: (date: Date) => string;\n  humanize?: Humanize;\n  height?: number;\n  loading?: boolean;\n  query?: string;\n  theme?: any; // TODO figure out the best way to import VictoryThemeDefinition\n  tickCount?: number;\n  title?: string;\n  data?: DataPoint[][];\n  xAxis?: boolean;\n  yAxis?: boolean;\n  padding?: object;\n  chartStyle?: object[];\n  byteDataType?: ByteDataTypes; //Use this to process the whole data frame at once\n};\n\ntype AreaProps = AreaChartProps & {\n  namespace?: string;\n  query: string;\n  samples?: number;\n  timeout?: string;\n  timespan?: number;\n  byteDataType?: ByteDataTypes;\n};\n"]}]}