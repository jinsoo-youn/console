{"remainingRequest":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js??ref--5-2!/home/jinsoo/hypercloud-console5.0/frontend/packages/container-security/src/components/image-manifest-vuln.tsx","dependencies":[{"path":"/home/jinsoo/hypercloud-console5.0/frontend/packages/container-security/src/components/image-manifest-vuln.tsx","mtime":1616735742380},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1607306270906},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1607306283100},{"path":"/home/jinsoo/hypercloud-console5.0/frontend/node_modules/ts-loader/index.js","mtime":1607306283339}],"contextDependencies":[],"result":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport * as classNames from 'classnames';\nimport { Tooltip } from '@patternfly/react-core';\nimport { sortable } from '@patternfly/react-table';\nimport { SecurityIcon } from '@patternfly/react-icons';\nimport { MultiListPage, Table, TableRow, TableData, DetailsPage, ListPage, } from '@console/internal/components/factory';\nimport { GreenCheckCircleIcon } from '@console/shared/';\nimport { referenceForModel } from '@console/internal/module/k8s';\nimport { ResourceLink, ExternalLink, navFactory, SectionHeading, ResourceSummary, DetailsItem, Firehose, Loading, MsgBox, } from '@console/internal/components/utils';\nimport { ChartDonut } from '@patternfly/react-charts';\nimport { DefaultList } from '@console/internal/components/default-resource';\nimport { vulnPriority, totalFor, priorityFor } from '../const';\nimport { ImageManifestVulnModel } from '../models';\nimport { quayURLFor } from './summary';\nimport './image-manifest-vuln.scss';\nimport { ContainerLink } from '@console/internal/components/pod';\nconst shortenImage = (img) => img\n    .replace('@sha256', '')\n    .split('/')\n    .slice(1, 3)\n    .join('/');\nconst shortenHash = (hash) => hash.slice(7, 18);\nexport const ImageVulnerabilityRow = (props) => {\n    return (React.createElement(\"div\", { className: \"row\" },\n        React.createElement(\"div\", { className: \"col-lg-3 col-md-3 col-sm-4 col-xs-6\" },\n            React.createElement(ExternalLink, { text: props.vulnerability.name, href: props.vulnerability.link })),\n        React.createElement(\"div\", { className: \"col-lg-2 col-md-2 col-sm-5 col-xs-6\" },\n            React.createElement(SecurityIcon, { color: priorityFor(props.vulnerability.severity).color.value }),\n            \"\\u00A0\",\n            props.vulnerability.severity),\n        React.createElement(\"div\", { className: \"col-lg-2 col-md-2 col-sm-3 hidden-xs\" }, props.packageName),\n        React.createElement(\"div\", { className: \"col-lg-2 col-md-2 hidden-sm hidden-xs\" }, props.currentVersion),\n        React.createElement(\"div\", { className: \"col-lg-3 col-md-3 hidden-sm hidden-xs\" }, props.vulnerability.fixedby || '-')));\n};\nexport const ImageVulnerabilitiesTable = (props) => {\n    const vulnerabilites = _.sortBy(_.flatten(props.features.map((feature) => feature.vulnerabilities.map((vulnerability) => ({ feature, vulnerability })))), (v) => priorityFor(v.vulnerability.severity).index);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(SectionHeading, { text: \"Vulnerabilities\" }),\n        React.createElement(\"div\", { className: \"co-m-table-grid co-m-table-grid--bordered\" },\n            React.createElement(\"div\", { className: \"row co-m-table-grid__head\" },\n                React.createElement(\"div\", { className: \"col-lg-3 col-md-3 col-sm-4 col-xs-6\" }, \"Vulnerability\"),\n                React.createElement(\"div\", { className: \"col-lg-2 col-md-2 col-sm-5 col-xs-6\" }, \"Severity\"),\n                React.createElement(\"div\", { className: \"col-lg-2 col-md-2 col-sm-3 hidden-xs\" }, \"Package\"),\n                React.createElement(\"div\", { className: \"col-lg-2 col-md-2 hidden-sm hidden-xs\" }, \"Current Version\"),\n                React.createElement(\"div\", { className: \"col-lg-3 col-md-3 hidden-sm hidden-xs\" }, \"Fixed in Version\")),\n            React.createElement(\"div\", { className: \"co-m-table-grid__body\" }, vulnerabilites.map(({ feature, vulnerability }) => (React.createElement(ImageVulnerabilityRow, { key: `${feature.name}-${vulnerability.name}`, vulnerability: vulnerability, packageName: feature.name, currentVersion: feature.version })))))));\n};\nexport const ImageManifestVulnDetails = (props) => {\n    const total = props.obj.spec.features.reduce((sum, f) => sum + f.vulnerabilities.length, 0);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { className: \"co-m-pane__body\" },\n            React.createElement(SectionHeading, { text: \"Image Manifest Vuln Details\" }),\n            React.createElement(\"div\", { style: { display: 'flex' } },\n                React.createElement(\"div\", { className: \"imagemanifestvuln-details__donut\" },\n                    React.createElement(ChartDonut, { colorScale: vulnPriority.map((priority) => priority.color.value).toArray(), data: vulnPriority\n                            .map((priority, key) => ({\n                            label: priority.title,\n                            x: priority.value,\n                            y: totalFor(key)(props.obj),\n                        }))\n                            .toArray(), title: `${total} total` })),\n                React.createElement(\"div\", { className: \"imagemanifestvuln-details__summary\" },\n                    React.createElement(\"h3\", null,\n                        \"Quay Security Scanner has detected \",\n                        total,\n                        \" vulnerabilities.\"),\n                    React.createElement(\"h4\", null,\n                        \"Patches are available for \",\n                        props.obj.status.fixableCount,\n                        \" vulnerabilities.\"),\n                    React.createElement(\"div\", { className: \"imagemanifestvuln-details__summary-list\" }, vulnPriority\n                        .map((v, k) => totalFor(k)(props.obj) > 0 ? (React.createElement(\"span\", { style: { margin: '5px' }, key: v.index },\n                        React.createElement(SecurityIcon, { color: v.color.value }),\n                        \"\\u00A0\",\n                        React.createElement(\"strong\", null, totalFor(k)(props.obj)),\n                        \" \",\n                        v.title,\n                        \" vulnerabilities.\")) : null)\n                        .toArray())))),\n        React.createElement(\"div\", { className: \"co-m-pane__body\" },\n            React.createElement(\"div\", { className: \"row\" },\n                React.createElement(\"div\", { className: \"col-sm-6\" },\n                    React.createElement(ResourceSummary, { resource: props.obj })),\n                React.createElement(\"div\", { className: \"col-sm-6\" },\n                    React.createElement(\"dl\", { className: \"co-m-pane__details\" },\n                        React.createElement(DetailsItem, { label: \"Registry\", obj: props.obj, path: \"spec.image\" }))))),\n        React.createElement(\"div\", { className: \"co-m-pane__body\" },\n            React.createElement(ImageVulnerabilitiesTable, { features: props.obj.spec.features }))));\n};\nexport const AffectedPods = (props) => {\n    const affectedPodsFor = (pods) => pods.filter((p) => _.keys(props.obj.status.affectedPods).includes([p.metadata.namespace, p.metadata.name].join('/')));\n    return (React.createElement(ListPage, { kind: \"Pod\", namespace: props.obj.metadata.namespace, canCreate: false, showTitle: false, ListComponent: (listProps) => (React.createElement(DefaultList, Object.assign({}, listProps, { data: affectedPodsFor(listProps.data) }))) }));\n};\nexport const ImageManifestVulnDetailsPage = (props) => {\n    return (React.createElement(DetailsPage, { match: props.match, kindObj: ImageManifestVulnModel, titleFunc: (obj) => !_.isEmpty(obj) ? `${shortenImage(obj.spec.image)}@${shortenHash(obj.spec.manifest)}` : null, name: props.match.params.name, namespace: props.match.params.ns, kind: referenceForModel(ImageManifestVulnModel), menuActions: [], pages: [\n            navFactory.details(ImageManifestVulnDetails),\n            navFactory.editYaml(),\n            {\n                href: 'pods',\n                name: 'Affected Pods',\n                component: AffectedPods,\n            },\n        ] }));\n};\n// TODO(alecmerdler): Fix classes here to ensure responsiveness\nconst tableColumnClasses = ['', '', '', '', '', ''];\nexport const ImageManifestVulnTableRow = ({ obj, index, key, style, }) => {\n    const { name, namespace } = obj.metadata;\n    return (React.createElement(TableRow, { id: obj.metadata.uid, index: index, trKey: key, style: style },\n        React.createElement(TableData, { className: tableColumnClasses[0] },\n            React.createElement(ResourceLink, { kind: referenceForModel(ImageManifestVulnModel), name: name, namespace: namespace, displayName: shortenImage(obj.spec.image) })),\n        React.createElement(TableData, { className: classNames(tableColumnClasses[1], 'co-break-word') },\n            React.createElement(ResourceLink, { kind: \"Namespace\", name: namespace })),\n        React.createElement(TableData, { className: tableColumnClasses[2] }, _.get(obj.status, 'highestSeverity') ? (React.createElement(React.Fragment, null,\n            React.createElement(SecurityIcon, { color: priorityFor(obj.status.highestSeverity).color.value }),\n            \"\\u00A0\",\n            obj.status.highestSeverity)) : (React.createElement(Loading, null))),\n        React.createElement(TableData, { className: tableColumnClasses[3] }, Object.keys(obj.status.affectedPods).length),\n        React.createElement(TableData, { className: tableColumnClasses[4] }, obj.status.fixableCount || 0),\n        React.createElement(TableData, { className: tableColumnClasses[4] },\n            React.createElement(ExternalLink, { text: shortenHash(obj.spec.manifest), href: quayURLFor(obj) }))));\n};\nexport const ImageManifestVulnTableHeader = () => [\n    {\n        title: 'Image Name',\n        sortField: 'spec.image',\n        transforms: [sortable],\n        props: { className: tableColumnClasses[0] },\n    },\n    {\n        title: 'Namespace',\n        sortField: 'metadata.namespace',\n        transforms: [sortable],\n        props: { className: tableColumnClasses[1] },\n    },\n    {\n        title: 'Highest Severity',\n        sortField: 'status.highestSeverity',\n        transforms: [sortable],\n        props: { className: tableColumnClasses[2] },\n    },\n    {\n        title: 'Affected Pods',\n        props: { className: tableColumnClasses[3] },\n    },\n    {\n        title: 'Fixable',\n        sortField: 'status.fixableCount',\n        transforms: [sortable],\n        props: { className: tableColumnClasses[4] },\n    },\n    {\n        title: 'Manifest',\n        props: { className: tableColumnClasses[5] },\n    },\n];\nexport const ImageManifestVulnList = (props) => {\n    const EmptyMsg = () => React.createElement(MsgBox, { title: \"No Image Vulnerabilities Found\", detail: \"\" });\n    return (React.createElement(Table, Object.assign({}, props, { \"aria-label\": \"Image Manifest Vulnerabilities\", Header: ImageManifestVulnTableHeader, Row: ImageManifestVulnTableRow, EmptyMsg: EmptyMsg, virtualize: true })));\n};\nexport const ImageManifestVulnPage = (props) => {\n    var _a;\n    const namespace = (_a = props.match.params) === null || _a === void 0 ? void 0 : _a.ns;\n    return (React.createElement(MultiListPage, Object.assign({}, props, { namespace: namespace, resources: [\n            {\n                kind: referenceForModel(ImageManifestVulnModel),\n                namespace,\n                namespaced: true,\n                prop: 'imageManifestVuln',\n            },\n        ], flatten: (resources) => _.get(resources.imageManifestVuln, 'data', []), title: \"Image Manifest Vulnerabilities\", canCreate: false, showTitle: true, hideToolbar: true, ListComponent: ImageManifestVulnList })));\n};\nconst podKey = (pod) => [pod.metadata.namespace, pod.metadata.name].join('/');\nexport const ContainerVulnerabilities = (props) => {\n    const vulnFor = (containerStatus) => _.get(props.imageManifestVuln, 'data', []).find((imv) => imv.status.affectedPods[podKey(props.pod)].some((id) => containerStatus.containerID === id) || containerStatus.imageID.includes(imv.spec.manifest));\n    const withVuln = (vuln, exists, absent) => (vuln !== undefined ? exists(vuln) : absent());\n    return (React.createElement(\"div\", { className: \"co-m-pane__body\" },\n        React.createElement(\"div\", { className: \"co-m-table-grid co-m-table-grid--bordered\" },\n            React.createElement(\"div\", { className: \"row co-m-table-grid__head\" },\n                React.createElement(\"div\", { className: \"col-md-3\" }, \"Container\"),\n                React.createElement(\"div\", { className: \"col-md-4\" }, \"Image\"),\n                React.createElement(\"div\", { className: \"col-md-2\" },\n                    React.createElement(Tooltip, { content: \"Results provided by Quay security scanner\" },\n                        React.createElement(\"span\", null, \"Security Scan\")))),\n            React.createElement(\"div\", { className: \"co-m-table-grid__body\" }, props.pod.status.containerStatuses.map((status) => (React.createElement(\"div\", { className: \"row\", key: status.containerID },\n                React.createElement(\"div\", { className: \"col-md-3\" },\n                    React.createElement(ContainerLink, { pod: props.pod, name: status.name })),\n                React.createElement(\"div\", { className: \"col-md-4 co-truncate co-nowrap co-select-to-copy\" }, props.pod.spec.containers.find((c) => c.name === status.name).image),\n                React.createElement(\"div\", { className: \"col-md-3\" }, props.loaded ? (withVuln(vulnFor(status), (vuln) => (React.createElement(\"span\", { style: { display: 'flex', alignItems: 'center' } },\n                    React.createElement(SecurityIcon, { color: priorityFor(_.get(vuln.status, 'highestSeverity')).color.value }),\n                    \"\\u00A0\",\n                    React.createElement(ResourceLink, { kind: referenceForModel(ImageManifestVulnModel), name: vuln.metadata.name, namespace: props.pod.metadata.namespace, title: vuln.metadata.uid, displayName: `${totalFor(vulnPriority.findKey(({ title }) => _.get(vuln.status, 'highestSeverity') === title))(vuln)} ${vuln.status.highestSeverity}`, hideIcon: true }))), () => (React.createElement(\"span\", null,\n                    React.createElement(GreenCheckCircleIcon, null),\n                    \"\\u00A0No vulnerabilities found\")))) : (React.createElement(\"div\", null,\n                    React.createElement(Loading, null)))))))))));\n};\nexport const ImageManifestVulnPodTab = (props) => {\n    return (React.createElement(Firehose, { resources: [\n            {\n                isList: true,\n                kind: referenceForModel(ImageManifestVulnModel),\n                namespace: props.match.params.ns,\n                selector: {\n                    matchLabels: { [podKey(props.obj)]: 'true' },\n                },\n                prop: 'imageManifestVuln',\n            },\n        ] },\n        React.createElement(ContainerVulnerabilities, Object.assign({ pod: props.obj }, props))));\n};\nImageManifestVulnPage.displayName = 'ImageManifestVulnPage';\nImageManifestVulnList.displayName = 'ImageManifestVulnList';\nAffectedPods.displayName = 'AffectedPods';\nImageVulnerabilitiesTable.displayName = 'ImageVulnerabilitiesTable';\nImageVulnerabilityRow.displayName = 'ImageVulnerabilityRow';\nImageManifestVulnPodTab.displayName = 'ImageManifestVulnPodTab';\nContainerVulnerabilities.displayName = 'ContainerVulnerabilities';\n",{"version":3,"file":"/home/jinsoo/hypercloud-console5.0/frontend/packages/container-security/src/components/image-manifest-vuln.tsx","sourceRoot":"","sources":["/home/jinsoo/hypercloud-console5.0/frontend/packages/container-security/src/components/image-manifest-vuln.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as _ from 'lodash';\nimport * as classNames from 'classnames';\nimport { Tooltip } from '@patternfly/react-core';\nimport { sortable } from '@patternfly/react-table';\nimport { SecurityIcon } from '@patternfly/react-icons';\nimport {\n  MultiListPage,\n  Table,\n  TableRow,\n  TableData,\n  DetailsPage,\n  ListPage,\n  RowFunction,\n} from '@console/internal/components/factory';\nimport { GreenCheckCircleIcon } from '@console/shared/';\nimport { referenceForModel, PodKind, ContainerStatus } from '@console/internal/module/k8s';\nimport { match } from 'react-router';\nimport {\n  ResourceLink,\n  ExternalLink,\n  navFactory,\n  SectionHeading,\n  ResourceSummary,\n  DetailsItem,\n  Firehose,\n  FirehoseResult,\n  Loading,\n  MsgBox,\n} from '@console/internal/components/utils';\nimport { ChartDonut } from '@patternfly/react-charts';\nimport { DefaultList } from '@console/internal/components/default-resource';\nimport { vulnPriority, totalFor, priorityFor } from '../const';\nimport { ImageManifestVuln, Feature, Vulnerability } from '../types';\nimport { ImageManifestVulnModel } from '../models';\nimport { quayURLFor } from './summary';\nimport './image-manifest-vuln.scss';\nimport { ContainerLink } from '@console/internal/components/pod';\n\nconst shortenImage = (img: string) =>\n  img\n    .replace('@sha256', '')\n    .split('/')\n    .slice(1, 3)\n    .join('/');\nconst shortenHash = (hash: string) => hash.slice(7, 18);\n\nexport const ImageVulnerabilityRow: React.FC<ImageVulnerabilityRowProps> = (props) => {\n  return (\n    <div className=\"row\">\n      <div className=\"col-lg-3 col-md-3 col-sm-4 col-xs-6\">\n        <ExternalLink text={props.vulnerability.name} href={props.vulnerability.link} />\n      </div>\n      <div className=\"col-lg-2 col-md-2 col-sm-5 col-xs-6\">\n        <SecurityIcon color={priorityFor(props.vulnerability.severity).color.value} />\n        &nbsp;{props.vulnerability.severity}\n      </div>\n      <div className=\"col-lg-2 col-md-2 col-sm-3 hidden-xs\">{props.packageName}</div>\n      <div className=\"col-lg-2 col-md-2 hidden-sm hidden-xs\">{props.currentVersion}</div>\n      <div className=\"col-lg-3 col-md-3 hidden-sm hidden-xs\">\n        {props.vulnerability.fixedby || '-'}\n      </div>\n    </div>\n  );\n};\n\nexport const ImageVulnerabilitiesTable: React.FC<ImageVulnerabilitiesTableProps> = (props) => {\n  const vulnerabilites = _.sortBy(\n    _.flatten(\n      props.features.map((feature) =>\n        feature.vulnerabilities.map((vulnerability) => ({ feature, vulnerability })),\n      ),\n    ),\n    (v) => priorityFor(v.vulnerability.severity).index,\n  );\n\n  return (\n    <>\n      <SectionHeading text=\"Vulnerabilities\" />\n      <div className=\"co-m-table-grid co-m-table-grid--bordered\">\n        <div className=\"row co-m-table-grid__head\">\n          <div className=\"col-lg-3 col-md-3 col-sm-4 col-xs-6\">Vulnerability</div>\n          <div className=\"col-lg-2 col-md-2 col-sm-5 col-xs-6\">Severity</div>\n          <div className=\"col-lg-2 col-md-2 col-sm-3 hidden-xs\">Package</div>\n          <div className=\"col-lg-2 col-md-2 hidden-sm hidden-xs\">Current Version</div>\n          <div className=\"col-lg-3 col-md-3 hidden-sm hidden-xs\">Fixed in Version</div>\n        </div>\n        <div className=\"co-m-table-grid__body\">\n          {vulnerabilites.map(({ feature, vulnerability }) => (\n            <ImageVulnerabilityRow\n              key={`${feature.name}-${vulnerability.name}`}\n              vulnerability={vulnerability}\n              packageName={feature.name}\n              currentVersion={feature.version}\n            />\n          ))}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport const ImageManifestVulnDetails: React.FC<ImageManifestVulnDetailsProps> = (props) => {\n  const total = props.obj.spec.features.reduce((sum, f) => sum + f.vulnerabilities.length, 0);\n\n  return (\n    <>\n      <div className=\"co-m-pane__body\">\n        <SectionHeading text=\"Image Manifest Vuln Details\" />\n        <div style={{ display: 'flex' }}>\n          <div className=\"imagemanifestvuln-details__donut\">\n            <ChartDonut\n              colorScale={vulnPriority.map((priority) => priority.color.value).toArray()}\n              data={vulnPriority\n                .map((priority, key) => ({\n                  label: priority.title,\n                  x: priority.value,\n                  y: totalFor(key)(props.obj),\n                }))\n                .toArray()}\n              title={`${total} total`}\n            />\n          </div>\n          <div className=\"imagemanifestvuln-details__summary\">\n            <h3>Quay Security Scanner has detected {total} vulnerabilities.</h3>\n            <h4>Patches are available for {props.obj.status.fixableCount} vulnerabilities.</h4>\n            <div className=\"imagemanifestvuln-details__summary-list\">\n              {vulnPriority\n                .map((v, k) =>\n                  totalFor(k)(props.obj) > 0 ? (\n                    <span style={{ margin: '5px' }} key={v.index}>\n                      <SecurityIcon color={v.color.value} />\n                      &nbsp;<strong>{totalFor(k)(props.obj)}</strong> {v.title} vulnerabilities.\n                    </span>\n                  ) : null,\n                )\n                .toArray()}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"co-m-pane__body\">\n        <div className=\"row\">\n          <div className=\"col-sm-6\">\n            <ResourceSummary resource={props.obj} />\n          </div>\n          <div className=\"col-sm-6\">\n            <dl className=\"co-m-pane__details\">\n              <DetailsItem label=\"Registry\" obj={props.obj} path=\"spec.image\" />\n            </dl>\n          </div>\n        </div>\n      </div>\n      <div className=\"co-m-pane__body\">\n        <ImageVulnerabilitiesTable features={props.obj.spec.features} />\n      </div>\n    </>\n  );\n};\n\nexport const AffectedPods: React.FC<AffectedPodsProps> = (props) => {\n  const affectedPodsFor = (pods: PodKind[]) =>\n    pods.filter((p) =>\n      _.keys(props.obj.status.affectedPods).includes(\n        [p.metadata.namespace, p.metadata.name].join('/'),\n      ),\n    );\n\n  return (\n    <ListPage\n      kind=\"Pod\"\n      namespace={props.obj.metadata.namespace}\n      canCreate={false}\n      showTitle={false}\n      ListComponent={(listProps) => (\n        <DefaultList {...listProps} data={affectedPodsFor(listProps.data)} />\n      )}\n    />\n  );\n};\n\nexport const ImageManifestVulnDetailsPage: React.FC<ImageManifestVulnDetailsPageProps> = (\n  props,\n) => {\n  return (\n    <DetailsPage\n      match={props.match}\n      kindObj={ImageManifestVulnModel}\n      titleFunc={(obj: ImageManifestVuln) =>\n        !_.isEmpty(obj) ? `${shortenImage(obj.spec.image)}@${shortenHash(obj.spec.manifest)}` : null\n      }\n      name={props.match.params.name}\n      namespace={props.match.params.ns}\n      kind={referenceForModel(ImageManifestVulnModel)}\n      menuActions={[]}\n      pages={[\n        navFactory.details(ImageManifestVulnDetails),\n        navFactory.editYaml(),\n        {\n          href: 'pods',\n          name: 'Affected Pods',\n          component: AffectedPods,\n        },\n      ]}\n    />\n  );\n};\n\n// TODO(alecmerdler): Fix classes here to ensure responsiveness\nconst tableColumnClasses = ['', '', '', '', '', ''];\n\nexport const ImageManifestVulnTableRow: RowFunction<ImageManifestVuln> = ({\n  obj,\n  index,\n  key,\n  style,\n}) => {\n  const { name, namespace } = obj.metadata;\n\n  return (\n    <TableRow id={obj.metadata.uid} index={index} trKey={key} style={style}>\n      <TableData className={tableColumnClasses[0]}>\n        <ResourceLink\n          kind={referenceForModel(ImageManifestVulnModel)}\n          name={name}\n          namespace={namespace}\n          displayName={shortenImage(obj.spec.image)}\n        />\n      </TableData>\n      <TableData className={classNames(tableColumnClasses[1], 'co-break-word')}>\n        <ResourceLink kind=\"Namespace\" name={namespace} />\n      </TableData>\n      <TableData className={tableColumnClasses[2]}>\n        {_.get(obj.status, 'highestSeverity') ? (\n          <>\n            <SecurityIcon color={priorityFor(obj.status.highestSeverity).color.value} />\n            &nbsp;{obj.status.highestSeverity}\n          </>\n        ) : (\n          <Loading />\n        )}\n      </TableData>\n      <TableData className={tableColumnClasses[3]}>\n        {Object.keys(obj.status.affectedPods).length}\n      </TableData>\n      <TableData className={tableColumnClasses[4]}>{obj.status.fixableCount || 0}</TableData>\n      <TableData className={tableColumnClasses[4]}>\n        <ExternalLink text={shortenHash(obj.spec.manifest)} href={quayURLFor(obj)} />\n      </TableData>\n    </TableRow>\n  );\n};\n\nexport const ImageManifestVulnTableHeader = () => [\n  {\n    title: 'Image Name',\n    sortField: 'spec.image',\n    transforms: [sortable],\n    props: { className: tableColumnClasses[0] },\n  },\n  {\n    title: 'Namespace',\n    sortField: 'metadata.namespace',\n    transforms: [sortable],\n    props: { className: tableColumnClasses[1] },\n  },\n  {\n    title: 'Highest Severity',\n    sortField: 'status.highestSeverity',\n    transforms: [sortable],\n    props: { className: tableColumnClasses[2] },\n  },\n  {\n    title: 'Affected Pods',\n    props: { className: tableColumnClasses[3] },\n  },\n  {\n    title: 'Fixable',\n    sortField: 'status.fixableCount',\n    transforms: [sortable],\n    props: { className: tableColumnClasses[4] },\n  },\n  {\n    title: 'Manifest',\n    props: { className: tableColumnClasses[5] },\n  },\n];\n\nexport const ImageManifestVulnList: React.FC<ImageManifestVulnListProps> = (props) => {\n  const EmptyMsg = () => <MsgBox title=\"No Image Vulnerabilities Found\" detail=\"\" />;\n\n  return (\n    <Table\n      {...props}\n      aria-label=\"Image Manifest Vulnerabilities\"\n      Header={ImageManifestVulnTableHeader}\n      Row={ImageManifestVulnTableRow}\n      EmptyMsg={EmptyMsg}\n      virtualize\n    />\n  );\n};\n\nexport const ImageManifestVulnPage: React.FC<ImageManifestVulnPageProps> = (props) => {\n  const namespace = props.match.params?.ns;\n\n  return (\n    <MultiListPage\n      {...props}\n      namespace={namespace}\n      resources={[\n        {\n          kind: referenceForModel(ImageManifestVulnModel),\n          namespace,\n          namespaced: true,\n          prop: 'imageManifestVuln',\n        },\n      ]}\n      flatten={(resources) => _.get(resources.imageManifestVuln, 'data', [])}\n      title=\"Image Manifest Vulnerabilities\"\n      canCreate={false}\n      showTitle\n      hideToolbar\n      ListComponent={ImageManifestVulnList}\n    />\n  );\n};\n\nconst podKey = (pod: PodKind) => [pod.metadata.namespace, pod.metadata.name].join('/');\n\nexport const ContainerVulnerabilities: React.FC<ContainerVulnerabilitiesProps> = (props) => {\n  const vulnFor = (containerStatus: ContainerStatus) =>\n    _.get(props.imageManifestVuln, 'data', []).find(\n      (imv) =>\n        imv.status.affectedPods[podKey(props.pod)].some(\n          (id) => containerStatus.containerID === id,\n        ) || containerStatus.imageID.includes(imv.spec.manifest),\n    );\n\n  const withVuln = (\n    vuln: ImageManifestVuln,\n    exists: (vuln: ImageManifestVuln) => JSX.Element,\n    absent: () => JSX.Element,\n  ) => (vuln !== undefined ? exists(vuln) : absent());\n\n  return (\n    <div className=\"co-m-pane__body\">\n      <div className=\"co-m-table-grid co-m-table-grid--bordered\">\n        <div className=\"row co-m-table-grid__head\">\n          <div className=\"col-md-3\">Container</div>\n          <div className=\"col-md-4\">Image</div>\n          <div className=\"col-md-2\">\n            <Tooltip content=\"Results provided by Quay security scanner\">\n              <span>Security Scan</span>\n            </Tooltip>\n          </div>\n        </div>\n        <div className=\"co-m-table-grid__body\">\n          {props.pod.status.containerStatuses.map((status) => (\n            <div className=\"row\" key={status.containerID}>\n              <div className=\"col-md-3\">\n                <ContainerLink pod={props.pod} name={status.name} />\n              </div>\n              <div className=\"col-md-4 co-truncate co-nowrap co-select-to-copy\">\n                {props.pod.spec.containers.find((c) => c.name === status.name).image}\n              </div>\n              <div className=\"col-md-3\">\n                {props.loaded ? (\n                  withVuln(\n                    vulnFor(status),\n                    (vuln) => (\n                      <span style={{ display: 'flex', alignItems: 'center' }}>\n                        <SecurityIcon\n                          color={priorityFor(_.get(vuln.status, 'highestSeverity')).color.value}\n                        />\n                        &nbsp;\n                        <ResourceLink\n                          kind={referenceForModel(ImageManifestVulnModel)}\n                          name={vuln.metadata.name}\n                          namespace={props.pod.metadata.namespace}\n                          title={vuln.metadata.uid}\n                          displayName={`${totalFor(\n                            vulnPriority.findKey(\n                              ({ title }) => _.get(vuln.status, 'highestSeverity') === title,\n                            ),\n                          )(vuln)} ${vuln.status.highestSeverity}`}\n                          hideIcon\n                        />\n                      </span>\n                    ),\n                    () => (\n                      <span>\n                        <GreenCheckCircleIcon />\n                        &nbsp;No vulnerabilities found\n                      </span>\n                    ),\n                  )\n                ) : (\n                  <div>\n                    <Loading />\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const ImageManifestVulnPodTab: React.FC<ImageManifestVulnPodTabProps> = (props) => {\n  return (\n    <Firehose\n      resources={[\n        {\n          isList: true,\n          kind: referenceForModel(ImageManifestVulnModel),\n          namespace: props.match.params.ns,\n          selector: {\n            matchLabels: { [podKey(props.obj)]: 'true' },\n          },\n          prop: 'imageManifestVuln',\n        },\n      ]}\n    >\n      {/* FIXME(alecmerdler): Hack because `Firehose` injects props without TypeScript knowing about it */}\n      <ContainerVulnerabilities pod={props.obj} {...(props as any)} />\n    </Firehose>\n  );\n};\n\nexport type ContainerVulnerabilitiesProps = {\n  loaded: boolean;\n  pod: PodKind;\n  imageManifestVuln: FirehoseResult<ImageManifestVuln[]>;\n};\n\nexport type ImageManifestVulnDetailsPageProps = {\n  match: match<{ ns: string; name: string }>;\n};\n\nexport type ImageManifestVulnPageProps = {\n  namespace?: string;\n  match?: match<{ ns?: string }>;\n  selector?: { [key: string]: string };\n};\n\nexport type ImageManifestVulnListProps = {\n  data: ImageManifestVuln[];\n};\n\nexport type ImageManifestVulnDetailsProps = {\n  obj: ImageManifestVuln;\n};\n\nexport type ImageManifestVulnListTableHeaderProps = {};\n\nexport type AffectedPodsProps = {\n  obj: ImageManifestVuln;\n};\n\nexport type ImageVulnerabilitiesTableProps = {\n  features: Feature[];\n};\n\nexport type ImageVulnerabilityRowProps = {\n  vulnerability: Vulnerability;\n  currentVersion: string;\n  packageName: string;\n};\n\nexport type ImageManifestVulnPodTabProps = {\n  match: match<{ ns: string; name: string }>;\n  obj: PodKind;\n};\n\nImageManifestVulnPage.displayName = 'ImageManifestVulnPage';\nImageManifestVulnList.displayName = 'ImageManifestVulnList';\nAffectedPods.displayName = 'AffectedPods';\nImageVulnerabilitiesTable.displayName = 'ImageVulnerabilitiesTable';\nImageVulnerabilityRow.displayName = 'ImageVulnerabilityRow';\nImageManifestVulnPodTab.displayName = 'ImageManifestVulnPodTab';\nContainerVulnerabilities.displayName = 'ContainerVulnerabilities';\n"]}]}